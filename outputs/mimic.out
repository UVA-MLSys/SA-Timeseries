Namespace(task_name='classification', train=False, model='DLinear', seed=2024, itrs=3, itr_no=None, data='mimic', result_path='./results', root_path='./dataset/mimic_iii/', data_path='mimic_iii.pkl', flag='test', features='MS', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=31, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, explainers=['feature_ablation', 'occlusion', 'augmented_occlusion', 'winIT', 'tsr'], areas=[0.05, 0.075, 0.1, 0.15], baseline_mode='random', metrics=['auc', 'accuracy', 'cross_entropy'], overwrite=True, dump_attrs=False, disable_progress=True, use_gpu=True, enc_in=31, dec_in=31, c_out=31)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_DLinear/1
test 2299
Loading model from ./results/mimic_iii_DLinear/1/checkpoint.pth
Running feature_ablation from 2024-07-12 17:04:36.223496
Experiment ended at 2024-07-12 17:05:39.306107. Total time taken 0:01:03.082611.
           metric   area      comp      suff
0        accuracy  0.050  0.984214  0.988418
1        accuracy  0.075  0.983997  0.988635
2        accuracy  0.100  0.984214  0.990588
3        accuracy  0.150  0.984214  0.992107
4             auc  0.050  0.334943  0.393728
5             auc  0.075  0.293793  0.395744
6             auc  0.100  0.269591  0.398346
7             auc  0.150  0.238168  0.399929
8   cross_entropy  0.050  0.106916  0.104917
9   cross_entropy  0.075  0.110504  0.104366
10  cross_entropy  0.100  0.113090  0.103514
11  cross_entropy  0.150  0.115968  0.103699

Running occlusion from 2024-07-12 17:05:39.477788
Experiment ended at 2024-07-12 17:06:51.311773. Total time taken 0:01:11.833985.
           metric   area      comp      suff
0        accuracy  0.050  0.984375  0.989366
1        accuracy  0.075  0.984375  0.989583
2        accuracy  0.100  0.984375  0.990234
3        accuracy  0.150  0.984375  0.991102
4             auc  0.050  0.302422  0.386156
5             auc  0.075  0.275878  0.386712
6             auc  0.100  0.259773  0.387623
7             auc  0.150  0.234114  0.387963
8   cross_entropy  0.050  0.108363  0.104234
9   cross_entropy  0.075  0.110774  0.104640
10  cross_entropy  0.100  0.112496  0.104663
11  cross_entropy  0.150  0.115764  0.104619

Running augmented_occlusion from 2024-07-12 17:06:51.454874
Experiment ended at 2024-07-12 17:08:09.419195. Total time taken 0:01:17.964321.
           metric   area      comp      suff
0        accuracy  0.050  0.984158  0.987413
1        accuracy  0.075  0.984158  0.988281
2        accuracy  0.100  0.984375  0.988498
3        accuracy  0.150  0.984375  0.988715
4             auc  0.050  0.359935  0.388747
5             auc  0.075  0.339296  0.391103
6             auc  0.100  0.321487  0.392593
7             auc  0.150  0.291237  0.396453
8   cross_entropy  0.050  0.098053  0.113611
9   cross_entropy  0.075  0.099729  0.113803
10  cross_entropy  0.100  0.100930  0.113143
11  cross_entropy  0.150  0.103512  0.113780

Running winIT from 2024-07-12 17:08:09.561602
Traceback (most recent call last):
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 73, in <module>
    main(args)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 42, in main
    interpreter.interpret(dataloader)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 183, in interpret
    results, attrs = self.run_classifier(dataloader, name)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 123, in run_classifier
    batch_results, batch_attr = self.evaluate(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 210, in evaluate
    attr = compute_attr(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/explainer.py", line 110, in compute_attr
    attr = explainer.attribute(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 107, in attribute
    counterfactuals = self.generate_counterfactuals(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 64, in generate_counterfactuals
    choices = self.data[input_index][:][:, :, feature_index].reshape(-1)
IndexError: too many indices for tensor of dimension 2
Namespace(task_name='classification', train=False, model='SegRNN', seed=2024, itrs=3, itr_no=None, data='mimic', result_path='./results', root_path='./dataset/mimic_iii/', data_path='mimic_iii.pkl', flag='test', features='MS', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=31, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, explainers=['feature_ablation', 'occlusion', 'augmented_occlusion', 'winIT', 'tsr'], areas=[0.05, 0.075, 0.1, 0.15], baseline_mode='random', metrics=['auc', 'accuracy', 'cross_entropy'], overwrite=True, dump_attrs=False, disable_progress=True, use_gpu=True, enc_in=31, dec_in=31, c_out=31)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_SegRNN/1
test 2299
Loading model from ./results/mimic_iii_SegRNN/1/checkpoint.pth
Running feature_ablation from 2024-07-12 17:08:22.654573
Experiment ended at 2024-07-12 17:10:47.639009. Total time taken 0:02:24.984436.
           metric   area      comp      suff
0        accuracy  0.050  0.798483  0.957031
1        accuracy  0.075  0.794359  0.962674
2        accuracy  0.100  0.799214  0.965712
3        accuracy  0.150  0.805331  0.969618
4             auc  0.050  0.496446  0.741700
5             auc  0.075  0.482979  0.753072
6             auc  0.100  0.474851  0.758263
7             auc  0.150  0.468591  0.764571
8   cross_entropy  0.050  0.442191  0.175317
9   cross_entropy  0.075  0.446601  0.159219
10  cross_entropy  0.100  0.444605  0.148384
11  cross_entropy  0.150  0.438946  0.136677

Running occlusion from 2024-07-12 17:10:47.800857
Experiment ended at 2024-07-12 17:13:14.381542. Total time taken 0:02:26.580685.
           metric   area      comp      suff
0        accuracy  0.050  0.799849  0.961171
1        accuracy  0.075  0.798941  0.963992
2        accuracy  0.100  0.793949  0.967287
3        accuracy  0.150  0.804583  0.975357
4             auc  0.050  0.592873  0.827102
5             auc  0.075  0.580467  0.839237
6             auc  0.100  0.566346  0.848153
7             auc  0.150  0.552770  0.856884
8   cross_entropy  0.050  0.438397  0.173998
9   cross_entropy  0.075  0.443190  0.158477
10  cross_entropy  0.100  0.443137  0.147501
11  cross_entropy  0.150  0.438770  0.135034

Running augmented_occlusion from 2024-07-12 17:13:14.555729
Experiment ended at 2024-07-12 17:16:13.541328. Total time taken 0:02:58.985599.
           metric   area      comp      suff
0        accuracy  0.050  0.918322  0.878368
1        accuracy  0.075  0.915067  0.885176
2        accuracy  0.100  0.913291  0.893816
3        accuracy  0.150  0.901532  0.903501
4             auc  0.050  0.625056  0.715660
5             auc  0.075  0.596675  0.733927
6             auc  0.100  0.578502  0.743006
7             auc  0.150  0.563075  0.762100
8   cross_entropy  0.050  0.243719  0.319995
9   cross_entropy  0.075  0.255727  0.307789
10  cross_entropy  0.100  0.267008  0.299381
11  cross_entropy  0.150  0.286113  0.285951

Running winIT from 2024-07-12 17:16:13.682589
Traceback (most recent call last):
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 73, in <module>
    main(args)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 42, in main
    interpreter.interpret(dataloader)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 183, in interpret
    results, attrs = self.run_classifier(dataloader, name)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 123, in run_classifier
    batch_results, batch_attr = self.evaluate(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 210, in evaluate
    attr = compute_attr(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/explainer.py", line 110, in compute_attr
    attr = explainer.attribute(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 107, in attribute
    counterfactuals = self.generate_counterfactuals(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 64, in generate_counterfactuals
    choices = self.data[input_index][:][:, :, feature_index].reshape(-1)
IndexError: too many indices for tensor of dimension 2
Namespace(task_name='classification', train=False, model='MICN', seed=2024, itrs=3, itr_no=None, data='mimic', result_path='./results', root_path='./dataset/mimic_iii/', data_path='mimic_iii.pkl', flag='test', features='MS', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=31, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, explainers=['feature_ablation', 'occlusion', 'augmented_occlusion', 'winIT', 'tsr'], areas=[0.05, 0.075, 0.1, 0.15], baseline_mode='random', metrics=['auc', 'accuracy', 'cross_entropy'], overwrite=True, dump_attrs=False, disable_progress=True, use_gpu=True, enc_in=31, dec_in=31, c_out=31)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_MICN/1
test 2299
Loading model from ./results/mimic_iii_MICN/1/checkpoint.pth
Traceback (most recent call last):
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 73, in <module>
    main(args)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 36, in main
    exp.load_best_model()
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_basic.py", line 81, in load_best_model
    self.model.load_state_dict(torch.load(best_model_path))
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1671, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for Model:
	size mismatch for conv_trans.mic.0.isometric_conv.1.weight: copying a param with shape torch.Size([128, 128, 3]) from checkpoint, the shape in current model is torch.Size([128, 128, 5]).
	size mismatch for conv_trans.mic.0.conv.0.weight: copying a param with shape torch.Size([128, 128, 24]) from checkpoint, the shape in current model is torch.Size([128, 128, 18]).
	size mismatch for conv_trans.mic.0.conv.1.weight: copying a param with shape torch.Size([128, 128, 24]) from checkpoint, the shape in current model is torch.Size([128, 128, 12]).
	size mismatch for conv_trans.mic.0.conv_trans.0.weight: copying a param with shape torch.Size([128, 128, 24]) from checkpoint, the shape in current model is torch.Size([128, 128, 18]).
	size mismatch for conv_trans.mic.0.conv_trans.1.weight: copying a param with shape torch.Size([128, 128, 24]) from checkpoint, the shape in current model is torch.Size([128, 128, 12]).
	size mismatch for conv_trans.projection.weight: copying a param with shape torch.Size([1, 128]) from checkpoint, the shape in current model is torch.Size([31, 128]).
	size mismatch for conv_trans.projection.bias: copying a param with shape torch.Size([1]) from checkpoint, the shape in current model is torch.Size([31]).
Namespace(task_name='classification', train=False, model='Crossformer', seed=2024, itrs=3, itr_no=None, data='mimic', result_path='./results', root_path='./dataset/mimic_iii/', data_path='mimic_iii.pkl', flag='test', features='MS', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=31, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, explainers=['feature_ablation', 'occlusion', 'augmented_occlusion', 'winIT', 'tsr'], areas=[0.05, 0.075, 0.1, 0.15], baseline_mode='random', metrics=['auc', 'accuracy', 'cross_entropy'], overwrite=True, dump_attrs=False, disable_progress=True, use_gpu=True, enc_in=31, dec_in=31, c_out=31)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_Crossformer/1
test 2299
Loading model from ./results/mimic_iii_Crossformer/1/checkpoint.pth
Running feature_ablation from 2024-07-12 17:16:32.445019
Experiment ended at 2024-07-12 17:22:51.336092. Total time taken 0:06:18.891073.
           metric   area      comp      suff
0        accuracy  0.050  0.989366  0.988281
1        accuracy  0.075  0.988932  0.988281
2        accuracy  0.100  0.989149  0.988281
3        accuracy  0.150  0.988715  0.989800
4             auc  0.050  0.315621  0.299671
5             auc  0.075  0.314942  0.308531
6             auc  0.100  0.312933  0.312694
7             auc  0.150  0.309666  0.315845
8   cross_entropy  0.050  0.088586  0.103471
9   cross_entropy  0.075  0.088680  0.104103
10  cross_entropy  0.100  0.089082  0.105143
11  cross_entropy  0.150  0.090230  0.107052

Running occlusion from 2024-07-12 17:22:51.502261
Experiment ended at 2024-07-12 17:29:19.249077. Total time taken 0:06:27.746816.
           metric   area      comp      suff
0        accuracy  0.050  0.988715  0.988281
1        accuracy  0.075  0.988715  0.988932
2        accuracy  0.100  0.988715  0.989149
3        accuracy  0.150  0.988715  0.990234
4             auc  0.050  0.273617  0.267024
5             auc  0.075  0.273053  0.270262
6             auc  0.100  0.272829  0.272835
7             auc  0.150  0.270696  0.274851
8   cross_entropy  0.050  0.089654  0.101579
9   cross_entropy  0.075  0.089628  0.102602
10  cross_entropy  0.100  0.089897  0.104349
11  cross_entropy  0.150  0.090908  0.107143

Running augmented_occlusion from 2024-07-12 17:29:19.392839
Experiment ended at 2024-07-12 17:35:53.497899. Total time taken 0:06:34.105060.
           metric   area      comp      suff
0        accuracy  0.050  0.988715  0.988281
1        accuracy  0.075  0.988715  0.988281
2        accuracy  0.100  0.988715  0.988932
3        accuracy  0.150  0.988715  0.990234
4             auc  0.050  0.330197  0.308292
5             auc  0.075  0.329518  0.318967
6             auc  0.100  0.329294  0.324798
7             auc  0.150  0.325687  0.327263
8   cross_entropy  0.050  0.082163  0.111802
9   cross_entropy  0.075  0.079989  0.115670
10  cross_entropy  0.100  0.078364  0.119137
11  cross_entropy  0.150  0.077739  0.123929

Running winIT from 2024-07-12 17:35:53.641041
Traceback (most recent call last):
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 73, in <module>
    main(args)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 42, in main
    interpreter.interpret(dataloader)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 183, in interpret
    results, attrs = self.run_classifier(dataloader, name)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 123, in run_classifier
    batch_results, batch_attr = self.evaluate(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 210, in evaluate
    attr = compute_attr(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/explainer.py", line 110, in compute_attr
    attr = explainer.attribute(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 107, in attribute
    counterfactuals = self.generate_counterfactuals(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 64, in generate_counterfactuals
    choices = self.data[input_index][:][:, :, feature_index].reshape(-1)
IndexError: too many indices for tensor of dimension 2
