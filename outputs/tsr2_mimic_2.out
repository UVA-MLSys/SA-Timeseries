
>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_DLinear/1
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_DLinear/1/checkpoint.pth
./results/mimic_iii_DLinear/1/tsr2.csv exists. Skipping ...

>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_DLinear/2
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_DLinear/2/checkpoint.pth
./results/mimic_iii_DLinear/2/tsr2.csv exists. Skipping ...

>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_DLinear/3
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_DLinear/3/checkpoint.pth
./results/mimic_iii_DLinear/3/tsr2.csv exists. Skipping ...

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_MICN/1
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_MICN/1/checkpoint.pth
./results/mimic_iii_MICN/1/tsr2.csv exists. Skipping ...

>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_MICN/2
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_MICN/2/checkpoint.pth
./results/mimic_iii_MICN/2/tsr2.csv exists. Skipping ...

>>>> itr_no: 3, seed: 608 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_MICN/3
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_MICN/3/checkpoint.pth
Running tsr2 from 2024-07-25 10:34:19.013865
Experiment ended at 2024-07-25 16:38:04.950529. Total time taken 6:03:45.936664.
           metric   area      comp      suff
0        accuracy  0.050  0.997613  0.955351
1        accuracy  0.075  0.997613  0.955351
2        accuracy  0.100  0.996094  0.955568
3        accuracy  0.150  0.996094  0.958173
4             auc  0.050  0.791667  0.516251
5             auc  0.075  0.791667  0.560859
6             auc  0.100  0.791543  0.629524
7             auc  0.150  0.791543  0.747549
8   cross_entropy  0.050  0.136520  0.218963
9   cross_entropy  0.075  0.137645  0.213961
10  cross_entropy  0.100  0.140069  0.205077
11  cross_entropy  0.150  0.146156  0.183245


>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_SegRNN_sl_48/1
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_SegRNN_sl_48/1/checkpoint.pth
Traceback (most recent call last):
  File "/u/mi3se/projects/SA-Timeseries/interpret.py", line 78, in <module>
    main(args)
  File "/u/mi3se/projects/SA-Timeseries/interpret.py", line 41, in main
    exp.load_best_model()
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_basic.py", line 88, in load_best_model
    self.model.load_state_dict(torch.load(best_model_path))
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/serialization.py", line 997, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/serialization.py", line 444, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/serialization.py", line 425, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: './results/mimic_iii_SegRNN_sl_48/1/checkpoint.pth'

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_iTransformer_sl_48/1
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_iTransformer_sl_48/1/checkpoint.pth
Running tsr2 from 2024-07-25 16:38:27.948493
Experiment ended at 2024-07-25 22:16:04.432721. Total time taken 5:37:36.484228.
           metric   area      comp      suff
0        accuracy  0.050  0.992405  0.946237
1        accuracy  0.075  0.988715  0.946277
2        accuracy  0.100  0.985026  0.950874
3        accuracy  0.150  0.984809  0.955906
4             auc  0.050  0.248200  0.149667
5             auc  0.075  0.249096  0.164484
6             auc  0.100  0.249104  0.180691
7             auc  0.150  0.246965  0.199502
8   cross_entropy  0.050  0.127370  0.208756
9   cross_entropy  0.075  0.132770  0.204332
10  cross_entropy  0.100  0.134197  0.199415
11  cross_entropy  0.150  0.138457  0.187412


>>>> itr_no: 2, seed: 506 <<<<<<
Use GPU: cuda:0
Dead patients 1832, percentage 9.96.
train 18390
Dead patients 229, percentage 9.96.
test 2299
Experiments will be saved in ./results/mimic_iii_iTransformer_sl_48/2
Dead patients 229, percentage 9.96.
test 2299
Loading model from ./results/mimic_iii_iTransformer_sl_48/2/checkpoint.pth
Running tsr2 from 2024-07-25 22:16:07.198689
Experiment ended at 2024-07-26 02:53:28.215722. Total time taken 4:37:21.017033.
Traceback (most recent call last):
  File "/u/mi3se/projects/SA-Timeseries/interpret.py", line 78, in <module>
    main(args)
  File "/u/mi3se/projects/SA-Timeseries/interpret.py", line 47, in main
    interpreter.interpret(dataloader)
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_interpret.py", line 283, in interpret
    time_efficiency_file.close()
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_interpret.py", line 354, in dump_results
    self.model, inputs=inputs, 
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/core/generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1014, in to_csv
    csv_formatter.save()
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 251, in save
    with get_handle(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/io/common.py", line 749, in get_handle
    check_parent_directory(str(handle))
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/pandas/io/common.py", line 616, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: 'results/mimic_iii_iTransformer_sl_48/2'
