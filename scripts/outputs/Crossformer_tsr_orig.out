Use GPU: cuda:0
Experiments will be saved in scratch/electricity_Crossformer
test 2607
Loading model from scratch/electricity_Crossformer/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['mae', 'mse']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 16:10:48.294566
  0%|          | 0/82 [00:00<?, ?it/s]  1%|          | 1/82 [01:08<1:33:00, 68.90s/it]  2%|▏         | 2/82 [02:16<1:31:06, 68.33s/it]  4%|▎         | 3/82 [03:24<1:29:37, 68.06s/it]  5%|▍         | 4/82 [04:32<1:28:35, 68.15s/it]  6%|▌         | 5/82 [05:40<1:27:19, 68.05s/it]  7%|▋         | 6/82 [06:48<1:26:04, 67.95s/it]  9%|▊         | 7/82 [07:56<1:24:58, 67.98s/it] 10%|▉         | 8/82 [09:04<1:23:46, 67.92s/it] 11%|█         | 9/82 [10:12<1:22:42, 67.98s/it] 12%|█▏        | 10/82 [11:20<1:21:32, 67.96s/it] 13%|█▎        | 11/82 [12:28<1:20:29, 68.02s/it] 15%|█▍        | 12/82 [13:37<1:19:39, 68.28s/it] 16%|█▌        | 13/82 [14:45<1:18:33, 68.32s/it] 17%|█▋        | 14/82 [15:53<1:17:23, 68.28s/it] 18%|█▊        | 15/82 [17:02<1:16:10, 68.22s/it] 20%|█▉        | 16/82 [18:10<1:14:58, 68.16s/it] 21%|██        | 17/82 [19:18<1:13:53, 68.21s/it] 22%|██▏       | 18/82 [20:26<1:12:40, 68.13s/it] 23%|██▎       | 19/82 [21:34<1:11:32, 68.13s/it] 24%|██▍       | 20/82 [22:44<1:11:01, 68.73s/it] 26%|██▌       | 21/82 [23:52<1:09:38, 68.51s/it] 27%|██▋       | 22/82 [25:00<1:08:21, 68.35s/it] 28%|██▊       | 23/82 [26:08<1:07:03, 68.20s/it] 29%|██▉       | 24/82 [27:16<1:05:53, 68.17s/it] 30%|███       | 25/82 [28:24<1:04:47, 68.20s/it] 32%|███▏      | 26/82 [29:33<1:03:43, 68.27s/it] 33%|███▎      | 27/82 [30:41<1:02:34, 68.26s/it] 34%|███▍      | 28/82 [31:49<1:01:22, 68.20s/it] 35%|███▌      | 29/82 [32:57<1:00:08, 68.09s/it] 37%|███▋      | 30/82 [34:05<58:54, 67.98s/it]   38%|███▊      | 31/82 [35:14<58:13, 68.49s/it] 39%|███▉      | 32/82 [36:23<57:11, 68.63s/it] 40%|████      | 33/82 [37:39<57:48, 70.79s/it] 41%|████▏     | 34/82 [38:51<56:55, 71.15s/it] 43%|████▎     | 35/82 [40:04<56:06, 71.63s/it] 44%|████▍     | 36/82 [41:17<55:14, 72.06s/it] 45%|████▌     | 37/82 [42:30<54:11, 72.25s/it] 46%|████▋     | 38/82 [43:45<53:46, 73.34s/it] 48%|████▊     | 39/82 [44:58<52:21, 73.06s/it] 49%|████▉     | 40/82 [46:08<50:36, 72.31s/it] 50%|█████     | 41/82 [47:19<49:03, 71.78s/it] 51%|█████     | 42/82 [48:30<47:38, 71.47s/it] 52%|█████▏    | 43/82 [49:40<46:18, 71.24s/it] 54%|█████▎    | 44/82 [50:51<45:03, 71.13s/it] 55%|█████▍    | 45/82 [52:02<43:47, 71.02s/it] 56%|█████▌    | 46/82 [53:13<42:34, 70.95s/it] 57%|█████▋    | 47/82 [54:24<41:22, 70.92s/it] 59%|█████▊    | 48/82 [55:34<40:07, 70.82s/it] 60%|█████▉    | 49/82 [56:43<38:33, 70.12s/it] 61%|██████    | 50/82 [57:51<37:09, 69.67s/it] 62%|██████▏   | 51/82 [59:02<36:07, 69.91s/it] 63%|██████▎   | 52/82 [1:00:13<35:07, 70.24s/it] 65%|██████▍   | 53/82 [1:01:23<33:59, 70.32s/it] 66%|██████▌   | 54/82 [1:02:34<32:52, 70.43s/it] 67%|██████▋   | 55/82 [1:03:47<31:58, 71.05s/it] 68%|██████▊   | 56/82 [1:04:58<30:54, 71.31s/it] 70%|██████▉   | 57/82 [1:06:09<29:38, 71.13s/it] 71%|███████   | 58/82 [1:07:20<28:23, 70.98s/it] 72%|███████▏  | 59/82 [1:08:30<27:09, 70.84s/it] 73%|███████▎  | 60/82 [1:09:41<25:57, 70.80s/it] 74%|███████▍  | 61/82 [1:10:52<24:46, 70.78s/it] 76%|███████▌  | 62/82 [1:12:03<23:35, 70.78s/it] 77%|███████▋  | 63/82 [1:13:14<22:28, 71.00s/it] 78%|███████▊  | 64/82 [1:14:28<21:34, 71.90s/it] 79%|███████▉  | 65/82 [1:15:42<20:33, 72.56s/it] 80%|████████  | 66/82 [1:16:56<19:27, 72.99s/it] 82%|████████▏ | 67/82 [1:18:10<18:17, 73.14s/it] 83%|████████▎ | 68/82 [1:19:23<17:06, 73.34s/it] 84%|████████▍ | 69/82 [1:20:34<15:42, 72.53s/it] 85%|████████▌ | 70/82 [1:21:45<14:23, 72.00s/it] 87%|████████▋ | 71/82 [1:22:56<13:10, 71.85s/it] 88%|████████▊ | 72/82 [1:24:06<11:53, 71.34s/it] 89%|████████▉ | 73/82 [1:25:15<10:35, 70.63s/it] 90%|█████████ | 74/82 [1:26:24<09:20, 70.02s/it] 91%|█████████▏| 75/82 [1:27:36<08:14, 70.66s/it] 93%|█████████▎| 76/82 [1:28:50<07:09, 71.55s/it] 94%|█████████▍| 77/82 [1:30:03<05:59, 71.95s/it] 95%|█████████▌| 78/82 [1:31:16<04:48, 72.23s/it] 96%|█████████▋| 79/82 [1:32:28<03:37, 72.43s/it] 98%|█████████▊| 80/82 [1:33:41<02:24, 72.42s/it] 99%|█████████▉| 81/82 [1:34:53<01:12, 72.27s/it]100%|██████████| 82/82 [1:35:58<00:00, 70.16s/it]100%|██████████| 82/82 [1:35:58<00:00, 70.23s/it]
Experiment ended at 2023-10-15 17:46:46.793687. Total time taken 1:35:58.499121.
  metric   area       comp       suff
0    mae  0.050  11.750957  11.827413
1    mae  0.075  13.479840  10.356981
2    mae  0.100  14.234896   9.594617
3    mae  0.150  15.462023   7.994136
4    mse  0.050   9.985294   9.145420
5    mse  0.075  12.608323   7.113958
6    mse  0.100  13.864053   6.173681
7    mse  0.150  15.908672   4.449514
Use GPU: cuda:0
Experiments will be saved in scratch/traffic_Crossformer
test 1731
Loading model from scratch/traffic_Crossformer/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['mae', 'mse']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 17:46:58.733613
  0%|          | 0/55 [00:00<?, ?it/s]  2%|▏         | 1/55 [01:13<1:05:52, 73.19s/it]  4%|▎         | 2/55 [02:31<1:07:28, 76.38s/it]  5%|▌         | 3/55 [03:45<1:05:12, 75.24s/it]  7%|▋         | 4/55 [04:57<1:02:39, 73.72s/it]  9%|▉         | 5/55 [06:08<1:00:48, 72.98s/it] 11%|█         | 6/55 [07:20<59:18, 72.63s/it]   13%|█▎        | 7/55 [08:32<57:47, 72.24s/it] 15%|█▍        | 8/55 [09:43<56:27, 72.07s/it] 16%|█▋        | 9/55 [10:55<55:10, 71.96s/it] 18%|█▊        | 10/55 [12:12<55:04, 73.44s/it] 20%|██        | 11/55 [13:25<53:50, 73.42s/it] 22%|██▏       | 12/55 [14:38<52:26, 73.17s/it] 24%|██▎       | 13/55 [15:51<51:09, 73.08s/it] 25%|██▌       | 14/55 [17:03<49:41, 72.73s/it] 27%|██▋       | 15/55 [18:15<48:20, 72.50s/it] 29%|██▉       | 16/55 [19:26<46:55, 72.19s/it] 31%|███       | 17/55 [20:38<45:36, 72.00s/it] 33%|███▎      | 18/55 [21:50<44:26, 72.07s/it] 35%|███▍      | 19/55 [23:00<42:54, 71.52s/it] 36%|███▋      | 20/55 [24:10<41:26, 71.04s/it] 38%|███▊      | 21/55 [25:19<39:51, 70.33s/it] 40%|████      | 22/55 [26:27<38:21, 69.73s/it] 42%|████▏     | 23/55 [27:36<37:05, 69.55s/it] 44%|████▎     | 24/55 [28:47<36:07, 69.92s/it] 45%|████▌     | 25/55 [29:57<35:03, 70.11s/it] 47%|████▋     | 26/55 [31:08<33:58, 70.31s/it] 49%|████▉     | 27/55 [32:19<32:51, 70.40s/it] 51%|█████     | 28/55 [33:30<31:43, 70.49s/it] 53%|█████▎    | 29/55 [34:39<30:23, 70.15s/it] 55%|█████▍    | 30/55 [35:47<28:58, 69.53s/it] 56%|█████▋    | 31/55 [36:56<27:43, 69.30s/it] 58%|█████▊    | 32/55 [38:04<26:29, 69.12s/it] 60%|██████    | 33/55 [39:13<25:17, 68.97s/it] 62%|██████▏   | 34/55 [40:21<24:03, 68.75s/it] 64%|██████▎   | 35/55 [41:30<22:54, 68.70s/it] 65%|██████▌   | 36/55 [42:39<21:46, 68.77s/it] 67%|██████▋   | 37/55 [43:48<20:39, 68.84s/it] 69%|██████▉   | 38/55 [44:57<19:30, 68.84s/it] 71%|███████   | 39/55 [46:06<18:21, 68.87s/it] 73%|███████▎  | 40/55 [47:14<17:12, 68.85s/it] 75%|███████▍  | 41/55 [48:23<16:04, 68.92s/it] 76%|███████▋  | 42/55 [49:32<14:56, 68.94s/it] 78%|███████▊  | 43/55 [50:41<13:47, 68.94s/it] 80%|████████  | 44/55 [51:50<12:38, 68.95s/it] 82%|████████▏ | 45/55 [52:59<11:29, 69.00s/it] 84%|████████▎ | 46/55 [54:09<10:21, 69.11s/it] 85%|████████▌ | 47/55 [55:18<09:12, 69.11s/it] 87%|████████▋ | 48/55 [56:27<08:03, 69.07s/it] 89%|████████▉ | 49/55 [57:36<06:54, 69.04s/it] 91%|█████████ | 50/55 [58:45<05:44, 68.97s/it] 93%|█████████▎| 51/55 [59:54<04:35, 68.97s/it] 95%|█████████▍| 52/55 [1:01:02<03:26, 68.78s/it] 96%|█████████▋| 53/55 [1:02:10<02:17, 68.58s/it] 98%|█████████▊| 54/55 [1:03:19<01:08, 68.53s/it]100%|██████████| 55/55 [1:04:18<00:00, 65.74s/it]100%|██████████| 55/55 [1:04:18<00:00, 70.15s/it]
Experiment ended at 2023-10-15 18:51:17.022734. Total time taken 1:04:18.289121.
  metric   area       comp       suff
0    mae  0.050   8.071214  18.804994
1    mae  0.075   9.594707  15.761626
2    mae  0.100  10.422612  14.098810
3    mae  0.150  12.277957  10.968051
4    mse  0.050   4.477453  19.994650
5    mse  0.075   6.136419  14.257711
6    mse  0.100   7.133228  11.506669
7    mse  0.150   9.657874   7.070959
Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in scratch/mimic_iii_Crossformer
test 2299
Loading model from scratch/mimic_iii_Crossformer/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['auc', 'accuracy', 'cross_entropy']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 18:51:32.256573
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:18<21:24, 18.09s/it]  3%|▎         | 2/72 [00:35<20:54, 17.91s/it]  4%|▍         | 3/72 [00:53<20:28, 17.80s/it]  6%|▌         | 4/72 [01:11<20:10, 17.80s/it]  7%|▋         | 5/72 [01:29<19:52, 17.80s/it]  8%|▊         | 6/72 [01:46<19:32, 17.77s/it] 10%|▉         | 7/72 [02:04<19:11, 17.72s/it] 11%|█         | 8/72 [02:22<18:57, 17.78s/it] 12%|█▎        | 9/72 [02:40<18:40, 17.79s/it] 14%|█▍        | 10/72 [02:57<18:21, 17.76s/it] 15%|█▌        | 11/72 [03:15<18:01, 17.72s/it] 17%|█▋        | 12/72 [03:33<17:44, 17.74s/it] 18%|█▊        | 13/72 [03:51<17:26, 17.74s/it] 19%|█▉        | 14/72 [04:08<17:06, 17.69s/it] 21%|██        | 15/72 [04:26<16:48, 17.69s/it] 22%|██▏       | 16/72 [04:43<16:29, 17.66s/it] 24%|██▎       | 17/72 [05:01<16:09, 17.63s/it] 25%|██▌       | 18/72 [05:19<15:52, 17.63s/it] 26%|██▋       | 19/72 [05:36<15:35, 17.65s/it] 28%|██▊       | 20/72 [05:54<15:17, 17.64s/it] 29%|██▉       | 21/72 [06:12<14:59, 17.64s/it] 31%|███       | 22/72 [06:29<14:41, 17.64s/it] 32%|███▏      | 23/72 [06:47<14:23, 17.62s/it] 33%|███▎      | 24/72 [07:04<14:06, 17.64s/it] 35%|███▍      | 25/72 [07:22<13:48, 17.63s/it] 36%|███▌      | 26/72 [07:40<13:31, 17.64s/it] 38%|███▊      | 27/72 [07:57<13:13, 17.62s/it] 39%|███▉      | 28/72 [08:15<12:57, 17.68s/it] 40%|████      | 29/72 [08:33<12:40, 17.68s/it] 42%|████▏     | 30/72 [08:50<12:22, 17.67s/it] 43%|████▎     | 31/72 [09:08<12:04, 17.67s/it] 44%|████▍     | 32/72 [09:26<11:47, 17.68s/it] 46%|████▌     | 33/72 [09:44<11:29, 17.69s/it] 47%|████▋     | 34/72 [10:01<11:11, 17.66s/it] 49%|████▊     | 35/72 [10:19<10:53, 17.66s/it] 50%|█████     | 36/72 [10:36<10:35, 17.64s/it] 51%|█████▏    | 37/72 [10:54<10:17, 17.66s/it] 53%|█████▎    | 38/72 [11:12<10:00, 17.67s/it] 54%|█████▍    | 39/72 [11:29<09:42, 17.64s/it] 56%|█████▌    | 40/72 [11:47<09:25, 17.68s/it] 57%|█████▋    | 41/72 [12:05<09:08, 17.70s/it] 58%|█████▊    | 42/72 [12:23<08:50, 17.69s/it] 60%|█████▉    | 43/72 [12:40<08:31, 17.65s/it] 61%|██████    | 44/72 [12:58<08:16, 17.73s/it] 62%|██████▎   | 45/72 [13:16<08:02, 17.87s/it] 64%|██████▍   | 46/72 [13:34<07:47, 18.00s/it] 65%|██████▌   | 47/72 [13:53<07:31, 18.06s/it] 67%|██████▋   | 48/72 [14:11<07:14, 18.11s/it] 68%|██████▊   | 49/72 [14:29<06:58, 18.20s/it] 69%|██████▉   | 50/72 [14:47<06:40, 18.19s/it] 71%|███████   | 51/72 [15:06<06:21, 18.19s/it] 72%|███████▏  | 52/72 [15:24<06:03, 18.19s/it] 74%|███████▎  | 53/72 [15:42<05:46, 18.21s/it] 75%|███████▌  | 54/72 [16:00<05:27, 18.22s/it] 76%|███████▋  | 55/72 [16:19<05:09, 18.20s/it] 78%|███████▊  | 56/72 [16:37<04:51, 18.20s/it] 79%|███████▉  | 57/72 [16:55<04:32, 18.18s/it] 81%|████████  | 58/72 [17:13<04:14, 18.19s/it] 82%|████████▏ | 59/72 [17:32<03:58, 18.32s/it] 83%|████████▎ | 60/72 [17:50<03:39, 18.27s/it] 85%|████████▍ | 61/72 [18:08<03:20, 18.26s/it] 86%|████████▌ | 62/72 [18:26<03:02, 18.24s/it] 88%|████████▊ | 63/72 [18:45<02:44, 18.27s/it] 89%|████████▉ | 64/72 [19:03<02:25, 18.24s/it] 90%|█████████ | 65/72 [19:21<02:07, 18.23s/it] 92%|█████████▏| 66/72 [19:39<01:48, 18.11s/it] 93%|█████████▎| 67/72 [19:57<01:30, 18.02s/it] 94%|█████████▍| 68/72 [20:14<01:11, 17.93s/it] 96%|█████████▌| 69/72 [20:32<00:53, 17.90s/it] 97%|█████████▋| 70/72 [20:50<00:35, 17.86s/it] 99%|█████████▊| 71/72 [21:08<00:17, 17.86s/it]100%|██████████| 72/72 [21:25<00:00, 17.58s/it]100%|██████████| 72/72 [21:25<00:00, 17.85s/it]
Experiment ended at 2023-10-15 19:12:57.506471. Total time taken 0:21:25.249898.
           metric   area      comp      suff
0        accuracy  0.050  0.966065  0.973878
1        accuracy  0.075  0.966065  0.973444
2        accuracy  0.100  0.964329  0.972930
3        accuracy  0.150  0.963895  0.968236
4             auc  0.050  0.689442  0.696245
5             auc  0.075  0.656561  0.706679
6             auc  0.100  0.614436  0.715621
7             auc  0.150  0.551595  0.725575
8   cross_entropy  0.050  0.103766  0.115665
9   cross_entropy  0.075  0.114826  0.117350
10  cross_entropy  0.100  0.126829  0.117357
11  cross_entropy  0.150  0.141850  0.120929
