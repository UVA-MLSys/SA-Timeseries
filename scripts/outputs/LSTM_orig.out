Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_LSTM
test 2299
Loading model from ./results/mimic_iii_LSTM/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['auc', 'accuracy', 'cross_entropy']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 22:41:40.200661

  0%|          | 0/72 [00:00<?, ?it/s]
  1%|▏         | 1/72 [00:00<00:48,  1.45it/s]
  3%|▎         | 2/72 [00:01<00:36,  1.94it/s]
  4%|▍         | 3/72 [00:01<00:31,  2.18it/s]
  6%|▌         | 4/72 [00:01<00:29,  2.31it/s]
  7%|▋         | 5/72 [00:02<00:28,  2.38it/s]
  8%|▊         | 6/72 [00:02<00:27,  2.43it/s]
 10%|▉         | 7/72 [00:03<00:26,  2.47it/s]
 11%|█         | 8/72 [00:03<00:25,  2.48it/s]
 12%|█▎        | 9/72 [00:03<00:25,  2.49it/s]
 14%|█▍        | 10/72 [00:04<00:24,  2.51it/s]
 15%|█▌        | 11/72 [00:04<00:24,  2.52it/s]
 17%|█▋        | 12/72 [00:05<00:23,  2.53it/s]
 18%|█▊        | 13/72 [00:05<00:23,  2.54it/s]
 19%|█▉        | 14/72 [00:05<00:22,  2.54it/s]
 21%|██        | 15/72 [00:06<00:22,  2.54it/s]
 22%|██▏       | 16/72 [00:06<00:22,  2.53it/s]
 24%|██▎       | 17/72 [00:06<00:21,  2.54it/s]
 25%|██▌       | 18/72 [00:07<00:21,  2.54it/s]
 26%|██▋       | 19/72 [00:07<00:20,  2.54it/s]
 28%|██▊       | 20/72 [00:08<00:20,  2.54it/s]
 29%|██▉       | 21/72 [00:08<00:20,  2.54it/s]
 31%|███       | 22/72 [00:08<00:19,  2.54it/s]
 32%|███▏      | 23/72 [00:09<00:19,  2.55it/s]
 33%|███▎      | 24/72 [00:09<00:18,  2.55it/s]
 35%|███▍      | 25/72 [00:10<00:18,  2.55it/s]
 36%|███▌      | 26/72 [00:10<00:18,  2.54it/s]
 38%|███▊      | 27/72 [00:10<00:17,  2.54it/s]
 39%|███▉      | 28/72 [00:11<00:17,  2.54it/s]
 40%|████      | 29/72 [00:11<00:16,  2.54it/s]
 42%|████▏     | 30/72 [00:12<00:16,  2.54it/s]
 43%|████▎     | 31/72 [00:12<00:16,  2.54it/s]
 44%|████▍     | 32/72 [00:12<00:15,  2.54it/s]
 46%|████▌     | 33/72 [00:13<00:15,  2.53it/s]
 47%|████▋     | 34/72 [00:13<00:14,  2.53it/s]
 49%|████▊     | 35/72 [00:14<00:14,  2.53it/s]
 50%|█████     | 36/72 [00:14<00:14,  2.53it/s]
 51%|█████▏    | 37/72 [00:14<00:13,  2.53it/s]
 53%|█████▎    | 38/72 [00:15<00:13,  2.54it/s]
 54%|█████▍    | 39/72 [00:15<00:13,  2.54it/s]
 56%|█████▌    | 40/72 [00:16<00:12,  2.54it/s]
 57%|█████▋    | 41/72 [00:16<00:12,  2.53it/s]
 58%|█████▊    | 42/72 [00:16<00:11,  2.54it/s]
 60%|█████▉    | 43/72 [00:17<00:11,  2.54it/s]
 61%|██████    | 44/72 [00:17<00:11,  2.54it/s]
 62%|██████▎   | 45/72 [00:18<00:10,  2.54it/s]
 64%|██████▍   | 46/72 [00:18<00:10,  2.54it/s]
 65%|██████▌   | 47/72 [00:18<00:09,  2.54it/s]
 67%|██████▋   | 48/72 [00:19<00:09,  2.53it/s]
 68%|██████▊   | 49/72 [00:19<00:09,  2.53it/s]
 69%|██████▉   | 50/72 [00:19<00:08,  2.53it/s]
 71%|███████   | 51/72 [00:20<00:08,  2.54it/s]
 72%|███████▏  | 52/72 [00:20<00:07,  2.54it/s]
 74%|███████▎  | 53/72 [00:21<00:07,  2.54it/s]
 75%|███████▌  | 54/72 [00:21<00:07,  2.53it/s]
 76%|███████▋  | 55/72 [00:21<00:06,  2.53it/s]
 78%|███████▊  | 56/72 [00:22<00:06,  2.53it/s]
 79%|███████▉  | 57/72 [00:22<00:05,  2.53it/s]
 81%|████████  | 58/72 [00:23<00:05,  2.53it/s]
 82%|████████▏ | 59/72 [00:23<00:05,  2.54it/s]
 83%|████████▎ | 60/72 [00:23<00:04,  2.53it/s]
 85%|████████▍ | 61/72 [00:24<00:04,  2.53it/s]
 86%|████████▌ | 62/72 [00:24<00:03,  2.53it/s]
 88%|████████▊ | 63/72 [00:25<00:03,  2.53it/s]
 89%|████████▉ | 64/72 [00:25<00:03,  2.54it/s]
 90%|█████████ | 65/72 [00:25<00:02,  2.54it/s]
 92%|█████████▏| 66/72 [00:26<00:02,  2.54it/s]
 93%|█████████▎| 67/72 [00:26<00:01,  2.54it/s]
 94%|█████████▍| 68/72 [00:27<00:01,  2.54it/s]
 96%|█████████▌| 69/72 [00:27<00:01,  2.54it/s]
 97%|█████████▋| 70/72 [00:27<00:00,  2.53it/s]
 99%|█████████▊| 71/72 [00:28<00:00,  2.53it/s]
100%|██████████| 72/72 [00:28<00:00,  2.58it/s]
100%|██████████| 72/72 [00:28<00:00,  2.51it/s]
Experiment ended at 2023-10-15 22:42:08.851476. Total time taken 0:00:28.650815.
           metric   area      comp      suff
0        accuracy  0.050  0.999132  0.939783
1        accuracy  0.075  0.998264  0.940217
2        accuracy  0.100  0.996094  0.941438
3        accuracy  0.150  0.994792  0.943689
4             auc  0.050  0.847222  0.644957
5             auc  0.075  0.847222  0.699702
6             auc  0.100  0.846774  0.728148
7             auc  0.150  0.846774  0.762588
8   cross_entropy  0.050  0.075645  0.225750
9   cross_entropy  0.075  0.075206  0.204316
10  cross_entropy  0.100  0.075221  0.185443
11  cross_entropy  0.150  0.074742  0.156478
Use GPU: cuda:0
Experiments will be saved in ./results/electricity_LSTM
test 2607
Loading model from ./results/electricity_LSTM/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['mae', 'mse']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 22:42:20.086092

  0%|          | 0/82 [00:00<?, ?it/s]
  1%|          | 1/82 [00:08<11:39,  8.64s/it]
  2%|▏         | 2/82 [00:16<11:11,  8.39s/it]
  4%|▎         | 3/82 [00:25<10:57,  8.32s/it]
  5%|▍         | 4/82 [00:33<10:46,  8.29s/it]
  6%|▌         | 5/82 [00:41<10:37,  8.28s/it]
  7%|▋         | 6/82 [00:49<10:28,  8.27s/it]
  9%|▊         | 7/82 [00:58<10:19,  8.26s/it]
 10%|▉         | 8/82 [01:06<10:09,  8.24s/it]
 11%|█         | 9/82 [01:14<10:01,  8.24s/it]
 12%|█▏        | 10/82 [01:22<09:52,  8.24s/it]
 13%|█▎        | 11/82 [01:30<09:44,  8.24s/it]
 15%|█▍        | 12/82 [01:39<09:36,  8.24s/it]
 16%|█▌        | 13/82 [01:47<09:27,  8.23s/it]
 17%|█▋        | 14/82 [01:55<09:19,  8.23s/it]
 18%|█▊        | 15/82 [02:03<09:11,  8.23s/it]
 20%|█▉        | 16/82 [02:12<09:03,  8.23s/it]
 21%|██        | 17/82 [02:20<08:55,  8.24s/it]
 22%|██▏       | 18/82 [02:28<08:47,  8.23s/it]
 23%|██▎       | 19/82 [02:36<08:38,  8.23s/it]
 24%|██▍       | 20/82 [02:45<08:30,  8.23s/it]
 26%|██▌       | 21/82 [02:53<08:22,  8.23s/it]
 27%|██▋       | 22/82 [03:01<08:14,  8.23s/it]
 28%|██▊       | 23/82 [03:09<08:05,  8.23s/it]
 29%|██▉       | 24/82 [03:17<07:57,  8.23s/it]
 30%|███       | 25/82 [03:26<07:48,  8.22s/it]
 32%|███▏      | 26/82 [03:34<07:40,  8.23s/it]
 33%|███▎      | 27/82 [03:42<07:32,  8.23s/it]
 34%|███▍      | 28/82 [03:50<07:24,  8.23s/it]
 35%|███▌      | 29/82 [03:59<07:15,  8.22s/it]
 37%|███▋      | 30/82 [04:07<07:07,  8.22s/it]
 38%|███▊      | 31/82 [04:15<06:59,  8.23s/it]
 39%|███▉      | 32/82 [04:23<06:51,  8.23s/it]
 40%|████      | 33/82 [04:32<06:43,  8.23s/it]
 41%|████▏     | 34/82 [04:40<06:34,  8.22s/it]
 43%|████▎     | 35/82 [04:48<06:26,  8.22s/it]
 44%|████▍     | 36/82 [04:56<06:18,  8.22s/it]
 45%|████▌     | 37/82 [05:04<06:10,  8.22s/it]
 46%|████▋     | 38/82 [05:13<06:01,  8.22s/it]
 48%|████▊     | 39/82 [05:21<05:53,  8.22s/it]
 49%|████▉     | 40/82 [05:29<05:45,  8.22s/it]
 50%|█████     | 41/82 [05:37<05:36,  8.22s/it]
 51%|█████     | 42/82 [05:46<05:28,  8.22s/it]
 52%|█████▏    | 43/82 [05:54<05:20,  8.23s/it]
 54%|█████▎    | 44/82 [06:02<05:12,  8.22s/it]
 55%|█████▍    | 45/82 [06:10<05:04,  8.22s/it]
 56%|█████▌    | 46/82 [06:18<04:55,  8.22s/it]
 57%|█████▋    | 47/82 [06:27<04:47,  8.22s/it]
 59%|█████▊    | 48/82 [06:35<04:39,  8.23s/it]
 60%|█████▉    | 49/82 [06:43<04:31,  8.23s/it]
 61%|██████    | 50/82 [06:51<04:23,  8.22s/it]
 62%|██████▏   | 51/82 [07:00<04:14,  8.22s/it]
 63%|██████▎   | 52/82 [07:08<04:06,  8.22s/it]
 65%|██████▍   | 53/82 [07:16<03:58,  8.22s/it]
 66%|██████▌   | 54/82 [07:24<03:50,  8.22s/it]
 67%|██████▋   | 55/82 [07:32<03:41,  8.22s/it]
 68%|██████▊   | 56/82 [07:41<03:33,  8.21s/it]
 70%|██████▉   | 57/82 [07:49<03:25,  8.22s/it]
 71%|███████   | 58/82 [07:57<03:17,  8.22s/it]
 72%|███████▏  | 59/82 [08:05<03:09,  8.22s/it]
 73%|███████▎  | 60/82 [08:13<03:00,  8.22s/it]
 74%|███████▍  | 61/82 [08:22<02:52,  8.21s/it]
 76%|███████▌  | 62/82 [08:30<02:44,  8.22s/it]
 77%|███████▋  | 63/82 [08:38<02:36,  8.22s/it]
 78%|███████▊  | 64/82 [08:46<02:28,  8.22s/it]
 79%|███████▉  | 65/82 [08:55<02:19,  8.22s/it]
 80%|████████  | 66/82 [09:03<02:11,  8.22s/it]
 82%|████████▏ | 67/82 [09:11<02:03,  8.21s/it]
 83%|████████▎ | 68/82 [09:19<01:55,  8.22s/it]
 84%|████████▍ | 69/82 [09:27<01:46,  8.23s/it]
 85%|████████▌ | 70/82 [09:36<01:38,  8.22s/it]
 87%|████████▋ | 71/82 [09:44<01:30,  8.21s/it]
 88%|████████▊ | 72/82 [09:52<01:22,  8.21s/it]
 89%|████████▉ | 73/82 [10:00<01:13,  8.21s/it]
 90%|█████████ | 74/82 [10:09<01:05,  8.22s/it]
 91%|█████████▏| 75/82 [10:17<00:57,  8.22s/it]
 93%|█████████▎| 76/82 [10:25<00:49,  8.22s/it]
 94%|█████████▍| 77/82 [10:33<00:41,  8.21s/it]
 95%|█████████▌| 78/82 [10:41<00:32,  8.22s/it]
 96%|█████████▋| 79/82 [10:50<00:24,  8.22s/it]
 98%|█████████▊| 80/82 [10:58<00:16,  8.22s/it]
 99%|█████████▉| 81/82 [11:06<00:08,  8.22s/it]
100%|██████████| 82/82 [11:14<00:00,  8.02s/it]
100%|██████████| 82/82 [11:14<00:00,  8.22s/it]
Experiment ended at 2023-10-15 22:53:34.195667. Total time taken 0:11:14.109575.
  metric   area      comp       suff
0    mae  0.050  0.087440  14.987973
1    mae  0.075  0.130874  13.842481
2    mae  0.100  0.184231  13.012994
3    mae  0.150  0.288252  11.238492
4    mse  0.050  0.001125  16.080302
5    mse  0.075  0.002266  13.914878
6    mse  0.100  0.004363  12.440948
7    mse  0.150  0.010630   9.692525

Use GPU: cuda:0
Experiments will be saved in ./results/traffic_LSTM
test 1731
Loading model from ./results/traffic_LSTM/checkpoint.pth
explainers: ['integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['mae', 'mse']

Interpreting with TSR enabled.
Running integrated_gradients from 2023-10-15 22:37:00.541844

  0%|          | 0/55 [00:00<?, ?it/s]
  2%|▏         | 1/55 [00:07<07:02,  7.82s/it]
  4%|▎         | 2/55 [00:15<06:44,  7.64s/it]
  5%|▌         | 3/55 [00:22<06:33,  7.58s/it]
  7%|▋         | 4/55 [00:30<06:24,  7.55s/it]
  9%|▉         | 5/55 [00:37<06:16,  7.53s/it]
 11%|█         | 6/55 [00:45<06:08,  7.52s/it]
 13%|█▎        | 7/55 [00:52<06:00,  7.51s/it]
 15%|█▍        | 8/55 [01:00<05:52,  7.51s/it]
 16%|█▋        | 9/55 [01:07<05:45,  7.50s/it]
 18%|█▊        | 10/55 [01:15<05:37,  7.50s/it]
 20%|██        | 11/55 [01:22<05:29,  7.50s/it]
 22%|██▏       | 12/55 [01:30<05:22,  7.50s/it]
 24%|██▎       | 13/55 [01:37<05:14,  7.50s/it]
 25%|██▌       | 14/55 [01:45<05:07,  7.50s/it]
 27%|██▋       | 15/55 [01:52<04:59,  7.49s/it]
 29%|██▉       | 16/55 [02:00<04:52,  7.49s/it]
 31%|███       | 17/55 [02:07<04:44,  7.50s/it]
 33%|███▎      | 18/55 [02:15<04:37,  7.49s/it]
 35%|███▍      | 19/55 [02:22<04:29,  7.50s/it]
 36%|███▋      | 20/55 [02:30<04:22,  7.50s/it]
 38%|███▊      | 21/55 [02:37<04:15,  7.50s/it]
 40%|████      | 22/55 [02:45<04:07,  7.50s/it]
 42%|████▏     | 23/55 [02:52<04:00,  7.50s/it]
 44%|████▎     | 24/55 [03:00<03:52,  7.50s/it]
 45%|████▌     | 25/55 [03:07<03:45,  7.50s/it]
 47%|████▋     | 26/55 [03:15<03:37,  7.50s/it]
 49%|████▉     | 27/55 [03:22<03:30,  7.50s/it]
 51%|█████     | 28/55 [03:30<03:22,  7.50s/it]
 53%|█████▎    | 29/55 [03:37<03:14,  7.50s/it]
 55%|█████▍    | 30/55 [03:45<03:07,  7.49s/it]
 56%|█████▋    | 31/55 [03:52<02:59,  7.49s/it]
 58%|█████▊    | 32/55 [04:00<02:52,  7.49s/it]
 60%|██████    | 33/55 [04:07<02:44,  7.50s/it]
 62%|██████▏   | 34/55 [04:15<02:37,  7.50s/it]
 64%|██████▎   | 35/55 [04:22<02:30,  7.50s/it]
 65%|██████▌   | 36/55 [04:30<02:22,  7.50s/it]
 67%|██████▋   | 37/55 [04:37<02:15,  7.50s/it]
 69%|██████▉   | 38/55 [04:45<02:07,  7.50s/it]
 71%|███████   | 39/55 [04:52<02:00,  7.51s/it]
 73%|███████▎  | 40/55 [05:00<01:52,  7.51s/it]
 75%|███████▍  | 41/55 [05:07<01:45,  7.50s/it]
 76%|███████▋  | 42/55 [05:15<01:37,  7.50s/it]
 78%|███████▊  | 43/55 [05:22<01:30,  7.51s/it]
 80%|████████  | 44/55 [05:30<01:22,  7.51s/it]
 82%|████████▏ | 45/55 [05:37<01:15,  7.51s/it]
 84%|████████▎ | 46/55 [05:45<01:07,  7.51s/it]
 85%|████████▌ | 47/55 [05:52<01:00,  7.51s/it]
 87%|████████▋ | 48/55 [06:00<00:52,  7.51s/it]
 89%|████████▉ | 49/55 [06:07<00:45,  7.51s/it]
 91%|█████████ | 50/55 [06:15<00:37,  7.52s/it]
 93%|█████████▎| 51/55 [06:22<00:30,  7.51s/it]
 95%|█████████▍| 52/55 [06:30<00:22,  7.51s/it]
 96%|█████████▋| 53/55 [06:37<00:15,  7.50s/it]
 98%|█████████▊| 54/55 [06:45<00:07,  7.50s/it]
100%|██████████| 55/55 [06:51<00:00,  7.11s/it]
100%|██████████| 55/55 [06:51<00:00,  7.48s/it]
Experiment ended at 2023-10-15 22:43:52.142162. Total time taken 0:06:51.600318.
  metric   area      comp       suff
0    mae  0.050  0.170343  19.186859
1    mae  0.075  0.288669  16.761499
2    mae  0.100  0.361479  15.076931
3    mae  0.150  0.465486  11.400322
4    mse  0.050  0.002670  22.988659
5    mse  0.075  0.007222  18.625359
6    mse  0.100  0.010780  15.797206
7    mse  0.150  0.018574   9.541848
