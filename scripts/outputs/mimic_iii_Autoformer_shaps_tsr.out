Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_Autoformer
test 2299
Loading model from ./results/mimic_iii_Autoformer/checkpoint.pth
explainers: ['deep_lift', 'gradient_shap', 'integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['auc', 'accuracy', 'cross_entropy']

Interpreting with TSR enabled.
Running deep_lift from 2023-10-14 18:33:28.191730
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:23<27:18, 23.08s/it]  3%|▎         | 2/72 [00:45<26:26, 22.66s/it]  4%|▍         | 3/72 [01:07<25:55, 22.55s/it]  6%|▌         | 4/72 [01:31<26:03, 22.99s/it]  7%|▋         | 5/72 [01:54<25:34, 22.90s/it]  8%|▊         | 6/72 [02:16<25:01, 22.74s/it] 10%|▉         | 7/72 [02:38<24:27, 22.57s/it] 11%|█         | 8/72 [03:01<23:58, 22.48s/it] 12%|█▎        | 9/72 [03:23<23:34, 22.45s/it] 14%|█▍        | 10/72 [03:45<23:10, 22.42s/it] 15%|█▌        | 11/72 [04:08<22:46, 22.40s/it] 17%|█▋        | 12/72 [04:30<22:22, 22.37s/it] 18%|█▊        | 13/72 [04:53<22:05, 22.46s/it] 19%|█▉        | 14/72 [05:15<21:44, 22.48s/it] 21%|██        | 15/72 [05:38<21:23, 22.51s/it] 22%|██▏       | 16/72 [06:01<21:02, 22.55s/it] 24%|██▎       | 17/72 [06:23<20:42, 22.59s/it] 25%|██▌       | 18/72 [06:46<20:23, 22.66s/it] 26%|██▋       | 19/72 [07:08<19:57, 22.59s/it] 28%|██▊       | 20/72 [07:31<19:34, 22.59s/it] 29%|██▉       | 21/72 [07:54<19:12, 22.60s/it] 31%|███       | 22/72 [08:16<18:49, 22.59s/it] 32%|███▏      | 23/72 [08:39<18:28, 22.62s/it] 33%|███▎      | 24/72 [09:01<18:03, 22.57s/it] 35%|███▍      | 25/72 [09:24<17:40, 22.55s/it] 36%|███▌      | 26/72 [09:47<17:18, 22.57s/it] 38%|███▊      | 27/72 [10:09<16:54, 22.54s/it] 39%|███▉      | 28/72 [10:32<16:31, 22.53s/it] 40%|████      | 29/72 [10:54<16:10, 22.56s/it] 42%|████▏     | 30/72 [11:17<15:49, 22.61s/it] 43%|████▎     | 31/72 [11:39<15:26, 22.60s/it] 44%|████▍     | 32/72 [12:02<15:03, 22.58s/it] 46%|████▌     | 33/72 [12:24<14:39, 22.56s/it] 47%|████▋     | 34/72 [12:47<14:16, 22.53s/it] 49%|████▊     | 35/72 [13:09<13:53, 22.52s/it] 50%|█████     | 36/72 [13:32<13:30, 22.51s/it] 51%|█████▏    | 37/72 [13:54<13:08, 22.52s/it] 53%|█████▎    | 38/72 [14:17<12:44, 22.50s/it] 54%|█████▍    | 39/72 [14:40<12:23, 22.54s/it] 56%|█████▌    | 40/72 [15:02<12:00, 22.52s/it] 57%|█████▋    | 41/72 [15:24<11:36, 22.47s/it] 58%|█████▊    | 42/72 [15:47<11:13, 22.44s/it] 60%|█████▉    | 43/72 [16:09<10:48, 22.37s/it] 61%|██████    | 44/72 [16:32<10:33, 22.64s/it] 62%|██████▎   | 45/72 [16:55<10:10, 22.60s/it] 64%|██████▍   | 46/72 [17:17<09:43, 22.46s/it] 65%|██████▌   | 47/72 [17:39<09:19, 22.37s/it] 67%|██████▋   | 48/72 [18:01<08:54, 22.28s/it] 68%|██████▊   | 49/72 [18:23<08:31, 22.24s/it] 69%|██████▉   | 50/72 [18:45<08:08, 22.21s/it] 71%|███████   | 51/72 [19:08<07:46, 22.21s/it] 72%|███████▏  | 52/72 [19:30<07:23, 22.18s/it] 74%|███████▎  | 53/72 [19:52<07:00, 22.15s/it] 75%|███████▌  | 54/72 [20:14<06:38, 22.13s/it] 76%|███████▋  | 55/72 [20:36<06:16, 22.13s/it] 78%|███████▊  | 56/72 [20:58<05:54, 22.15s/it] 79%|███████▉  | 57/72 [21:20<05:32, 22.16s/it] 81%|████████  | 58/72 [21:43<05:10, 22.19s/it] 82%|████████▏ | 59/72 [22:05<04:48, 22.22s/it] 83%|████████▎ | 60/72 [22:27<04:26, 22.20s/it] 85%|████████▍ | 61/72 [22:49<04:04, 22.19s/it] 86%|████████▌ | 62/72 [23:11<03:41, 22.20s/it] 88%|████████▊ | 63/72 [23:34<03:20, 22.26s/it] 89%|████████▉ | 64/72 [23:56<02:58, 22.27s/it] 90%|█████████ | 65/72 [24:19<02:36, 22.31s/it] 92%|█████████▏| 66/72 [24:41<02:14, 22.35s/it] 93%|█████████▎| 67/72 [25:04<01:51, 22.40s/it] 94%|█████████▍| 68/72 [25:26<01:29, 22.37s/it] 96%|█████████▌| 69/72 [25:49<01:07, 22.47s/it] 97%|█████████▋| 70/72 [26:11<00:44, 22.45s/it] 99%|█████████▊| 71/72 [26:33<00:22, 22.41s/it]100%|██████████| 72/72 [26:55<00:00, 22.25s/it]100%|██████████| 72/72 [26:55<00:00, 22.44s/it]
Experiment ended at 2023-10-14 19:00:23.846486. Total time taken 0:26:55.654756.
           metric   area      comp      suff
0        accuracy  0.050  0.838140  0.943496
1        accuracy  0.075  0.782231  0.940458
2        accuracy  0.100  0.760529  0.943930
3        accuracy  0.150  0.704813  0.942628
4             auc  0.050  0.280535  0.573233
5             auc  0.075  0.250256  0.591368
6             auc  0.100  0.218091  0.613937
7             auc  0.150  0.196066  0.635256
8   cross_entropy  0.050  0.395916  0.245848
9   cross_entropy  0.075  0.475144  0.235679
10  cross_entropy  0.100  0.527644  0.227254
11  cross_entropy  0.150  0.600980  0.219302
Running gradient_shap from 2023-10-14 19:00:23.881846
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:22<27:05, 22.89s/it]  3%|▎         | 2/72 [00:45<26:38, 22.83s/it]  4%|▍         | 3/72 [01:08<26:17, 22.86s/it]  6%|▌         | 4/72 [01:31<25:57, 22.90s/it]  7%|▋         | 5/72 [01:54<25:33, 22.89s/it]  8%|▊         | 6/72 [02:17<25:10, 22.88s/it] 10%|▉         | 7/72 [02:40<24:47, 22.89s/it] 11%|█         | 8/72 [03:03<24:24, 22.89s/it] 12%|█▎        | 9/72 [03:25<24:02, 22.89s/it] 14%|█▍        | 10/72 [03:48<23:35, 22.84s/it] 15%|█▌        | 11/72 [04:11<23:12, 22.82s/it] 17%|█▋        | 12/72 [04:35<23:05, 23.09s/it] 18%|█▊        | 13/72 [04:58<22:48, 23.19s/it] 19%|█▉        | 14/72 [05:21<22:15, 23.03s/it] 21%|██        | 15/72 [05:43<21:45, 22.91s/it] 22%|██▏       | 16/72 [06:06<21:19, 22.86s/it] 24%|██▎       | 17/72 [06:29<20:56, 22.85s/it] 25%|██▌       | 18/72 [06:52<20:31, 22.81s/it] 26%|██▋       | 19/72 [07:15<20:09, 22.82s/it] 28%|██▊       | 20/72 [07:37<19:43, 22.76s/it] 29%|██▉       | 21/72 [08:00<19:18, 22.72s/it] 31%|███       | 22/72 [08:22<18:48, 22.56s/it] 32%|███▏      | 23/72 [08:44<18:19, 22.43s/it] 33%|███▎      | 24/72 [09:06<17:54, 22.38s/it] 35%|███▍      | 25/72 [09:29<17:30, 22.35s/it] 36%|███▌      | 26/72 [09:51<17:09, 22.39s/it] 38%|███▊      | 27/72 [10:13<16:44, 22.32s/it] 39%|███▉      | 28/72 [10:35<16:18, 22.24s/it] 40%|████      | 29/72 [10:58<15:56, 22.24s/it] 42%|████▏     | 30/72 [11:20<15:33, 22.22s/it] 43%|████▎     | 31/72 [11:42<15:13, 22.29s/it] 44%|████▍     | 32/72 [12:04<14:50, 22.25s/it] 46%|████▌     | 33/72 [12:27<14:26, 22.22s/it] 47%|████▋     | 34/72 [12:49<14:04, 22.21s/it] 49%|████▊     | 35/72 [13:11<13:41, 22.20s/it] 50%|█████     | 36/72 [13:33<13:18, 22.17s/it] 51%|█████▏    | 37/72 [13:55<12:56, 22.17s/it] 53%|█████▎    | 38/72 [14:17<12:33, 22.17s/it] 54%|█████▍    | 39/72 [14:40<12:12, 22.21s/it] 56%|█████▌    | 40/72 [15:02<11:52, 22.26s/it] 57%|█████▋    | 41/72 [15:25<11:33, 22.38s/it] 58%|█████▊    | 42/72 [15:47<11:11, 22.39s/it] 60%|█████▉    | 43/72 [16:10<10:50, 22.43s/it] 61%|██████    | 44/72 [16:32<10:28, 22.43s/it] 62%|██████▎   | 45/72 [16:55<10:07, 22.50s/it] 64%|██████▍   | 46/72 [17:17<09:46, 22.54s/it] 65%|██████▌   | 47/72 [17:40<09:22, 22.52s/it] 67%|██████▋   | 48/72 [18:03<09:01, 22.58s/it] 68%|██████▊   | 49/72 [18:25<08:40, 22.61s/it] 69%|██████▉   | 50/72 [18:48<08:16, 22.57s/it] 71%|███████   | 51/72 [19:10<07:54, 22.60s/it] 72%|███████▏  | 52/72 [19:33<07:35, 22.76s/it] 74%|███████▎  | 53/72 [19:57<07:17, 23.04s/it] 75%|███████▌  | 54/72 [20:20<06:52, 22.89s/it] 76%|███████▋  | 55/72 [20:42<06:26, 22.72s/it] 78%|███████▊  | 56/72 [21:04<06:01, 22.61s/it] 79%|███████▉  | 57/72 [21:27<05:37, 22.51s/it] 81%|████████  | 58/72 [21:49<05:13, 22.41s/it] 82%|████████▏ | 59/72 [22:11<04:51, 22.40s/it] 83%|████████▎ | 60/72 [22:34<04:28, 22.38s/it] 85%|████████▍ | 61/72 [22:56<04:06, 22.39s/it] 86%|████████▌ | 62/72 [23:18<03:43, 22.35s/it] 88%|████████▊ | 63/72 [23:41<03:20, 22.33s/it] 89%|████████▉ | 64/72 [24:03<02:58, 22.33s/it] 90%|█████████ | 65/72 [24:25<02:36, 22.32s/it] 92%|█████████▏| 66/72 [24:48<02:14, 22.36s/it] 93%|█████████▎| 67/72 [25:10<01:51, 22.36s/it] 94%|█████████▍| 68/72 [25:33<01:29, 22.47s/it] 96%|█████████▌| 69/72 [25:55<01:07, 22.53s/it] 97%|█████████▋| 70/72 [26:18<00:45, 22.53s/it] 99%|█████████▊| 71/72 [26:40<00:22, 22.53s/it]100%|██████████| 72/72 [27:02<00:00, 22.23s/it]100%|██████████| 72/72 [27:02<00:00, 22.53s/it]
Experiment ended at 2023-10-14 19:27:26.313160. Total time taken 0:27:02.431314.
           metric   area      comp      suff
0        accuracy  0.050  0.844136  0.940892
1        accuracy  0.075  0.788934  0.939590
2        accuracy  0.100  0.752829  0.940458
3        accuracy  0.150  0.699010  0.945152
4             auc  0.050  0.266214  0.563264
5             auc  0.075  0.233402  0.590033
6             auc  0.100  0.213056  0.618642
7             auc  0.150  0.169665  0.634151
8   cross_entropy  0.050  0.384683  0.239169
9   cross_entropy  0.075  0.463872  0.231632
10  cross_entropy  0.100  0.525348  0.222410
11  cross_entropy  0.150  0.601763  0.214191
Running integrated_gradients from 2023-10-14 19:27:26.338041
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:22<26:33, 22.44s/it]  3%|▎         | 2/72 [00:44<26:14, 22.49s/it]  4%|▍         | 3/72 [01:07<25:51, 22.49s/it]  6%|▌         | 4/72 [01:29<25:30, 22.51s/it]  7%|▋         | 5/72 [01:52<25:06, 22.48s/it]  8%|▊         | 6/72 [02:14<24:40, 22.43s/it] 10%|▉         | 7/72 [02:37<24:18, 22.44s/it] 11%|█         | 8/72 [02:59<23:50, 22.36s/it] 12%|█▎        | 9/72 [03:21<23:28, 22.36s/it] 14%|█▍        | 10/72 [03:44<23:04, 22.32s/it] 15%|█▌        | 11/72 [04:06<22:37, 22.26s/it] 17%|█▋        | 12/72 [04:28<22:15, 22.26s/it] 18%|█▊        | 13/72 [04:50<21:53, 22.27s/it] 19%|█▉        | 14/72 [05:12<21:31, 22.27s/it] 21%|██        | 15/72 [05:35<21:07, 22.23s/it] 22%|██▏       | 16/72 [05:57<20:48, 22.29s/it] 24%|██▎       | 17/72 [06:19<20:24, 22.26s/it] 25%|██▌       | 18/72 [06:42<20:02, 22.28s/it] 26%|██▋       | 19/72 [07:04<19:40, 22.27s/it] 28%|██▊       | 20/72 [07:26<19:17, 22.25s/it] 29%|██▉       | 21/72 [07:50<19:20, 22.76s/it] 31%|███       | 22/72 [08:12<18:50, 22.61s/it] 32%|███▏      | 23/72 [08:35<18:24, 22.54s/it] 33%|███▎      | 24/72 [08:57<17:58, 22.46s/it] 35%|███▍      | 25/72 [09:19<17:33, 22.42s/it] 36%|███▌      | 26/72 [09:41<17:07, 22.35s/it] 38%|███▊      | 27/72 [10:04<16:43, 22.30s/it] 39%|███▉      | 28/72 [10:26<16:18, 22.25s/it] 40%|████      | 29/72 [10:48<15:55, 22.21s/it] 42%|████▏     | 30/72 [11:10<15:30, 22.16s/it] 43%|████▎     | 31/72 [11:32<15:08, 22.16s/it] 44%|████▍     | 32/72 [11:54<14:46, 22.16s/it] 46%|████▌     | 33/72 [12:16<14:24, 22.17s/it] 47%|████▋     | 34/72 [12:39<14:04, 22.21s/it] 49%|████▊     | 35/72 [13:01<13:41, 22.19s/it] 50%|█████     | 36/72 [13:23<13:17, 22.16s/it] 51%|█████▏    | 37/72 [13:45<12:54, 22.13s/it] 53%|█████▎    | 38/72 [14:07<12:32, 22.14s/it] 54%|█████▍    | 39/72 [14:29<12:09, 22.10s/it] 56%|█████▌    | 40/72 [14:51<11:46, 22.09s/it] 57%|█████▋    | 41/72 [15:13<11:24, 22.09s/it] 58%|█████▊    | 42/72 [15:35<11:02, 22.08s/it] 60%|█████▉    | 43/72 [15:57<10:40, 22.08s/it] 61%|██████    | 44/72 [16:19<10:17, 22.07s/it] 62%|██████▎   | 45/72 [16:41<09:55, 22.06s/it] 64%|██████▍   | 46/72 [17:04<09:33, 22.07s/it] 65%|██████▌   | 47/72 [17:26<09:11, 22.06s/it] 67%|██████▋   | 48/72 [17:48<08:50, 22.11s/it] 68%|██████▊   | 49/72 [18:10<08:28, 22.10s/it] 69%|██████▉   | 50/72 [18:32<08:05, 22.07s/it] 71%|███████   | 51/72 [18:54<07:44, 22.10s/it] 72%|███████▏  | 52/72 [19:16<07:22, 22.11s/it] 74%|███████▎  | 53/72 [19:38<07:00, 22.12s/it] 75%|███████▌  | 54/72 [20:01<06:38, 22.13s/it] 76%|███████▋  | 55/72 [20:23<06:16, 22.14s/it] 78%|███████▊  | 56/72 [20:45<05:54, 22.13s/it] 79%|███████▉  | 57/72 [21:07<05:32, 22.16s/it] 81%|████████  | 58/72 [21:29<05:10, 22.18s/it] 82%|████████▏ | 59/72 [21:52<04:48, 22.23s/it] 83%|████████▎ | 60/72 [22:14<04:26, 22.23s/it] 85%|████████▍ | 61/72 [22:37<04:06, 22.43s/it] 86%|████████▌ | 62/72 [23:00<03:46, 22.69s/it] 88%|████████▊ | 63/72 [23:22<03:22, 22.55s/it] 89%|████████▉ | 64/72 [23:45<02:59, 22.47s/it] 90%|█████████ | 65/72 [24:07<02:36, 22.40s/it] 92%|█████████▏| 66/72 [24:29<02:13, 22.30s/it] 93%|█████████▎| 67/72 [24:51<01:51, 22.22s/it] 94%|█████████▍| 68/72 [25:13<01:28, 22.16s/it] 96%|█████████▌| 69/72 [25:35<01:06, 22.13s/it] 97%|█████████▋| 70/72 [25:57<00:44, 22.12s/it] 99%|█████████▊| 71/72 [26:19<00:22, 22.15s/it]100%|██████████| 72/72 [26:40<00:00, 21.88s/it]100%|██████████| 72/72 [26:40<00:00, 22.24s/it]
Experiment ended at 2023-10-14 19:54:07.335206. Total time taken 0:26:40.997165.
           metric   area      comp      suff
0        accuracy  0.050  0.847495  0.949653
1        accuracy  0.075  0.799672  0.950087
2        accuracy  0.100  0.755321  0.947402
3        accuracy  0.150  0.716532  0.947836
4             auc  0.050  0.351776  0.605608
5             auc  0.075  0.288604  0.625540
6             auc  0.100  0.262221  0.642949
7             auc  0.150  0.242806  0.668036
8   cross_entropy  0.050  0.383713  0.236711
9   cross_entropy  0.075  0.465351  0.229724
10  cross_entropy  0.100  0.517821  0.222273
11  cross_entropy  0.150  0.583857  0.213585
