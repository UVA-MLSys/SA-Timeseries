Use GPU: cuda:0
train 18390
test 2299
Experiments will be saved in ./results/mimic_iii_Crossformer
test 2299
Loading model from ./results/mimic_iii_Crossformer/checkpoint.pth
explainers: ['deep_lift', 'gradient_shap', 'integrated_gradients']
 areas: [0.05, 0.075, 0.1, 0.15]
 metrics: ['auc', 'accuracy', 'cross_entropy']

Interpreting with TSR enabled.
Running deep_lift from 2023-10-15 11:56:50.550937
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:18<21:51, 18.47s/it]  3%|▎         | 2/72 [00:36<21:21, 18.31s/it]  4%|▍         | 3/72 [00:54<21:00, 18.27s/it]  6%|▌         | 4/72 [01:13<20:39, 18.23s/it]  7%|▋         | 5/72 [01:31<20:18, 18.19s/it]  8%|▊         | 6/72 [01:49<20:00, 18.18s/it] 10%|▉         | 7/72 [02:07<19:41, 18.17s/it] 11%|█         | 8/72 [02:26<19:29, 18.28s/it] 12%|█▎        | 9/72 [02:44<19:21, 18.44s/it] 14%|█▍        | 10/72 [03:03<19:02, 18.43s/it] 15%|█▌        | 11/72 [03:21<18:42, 18.40s/it] 17%|█▋        | 12/72 [03:39<18:20, 18.34s/it] 18%|█▊        | 13/72 [03:57<17:58, 18.28s/it] 19%|█▉        | 14/72 [04:16<17:40, 18.29s/it] 21%|██        | 15/72 [04:34<17:20, 18.26s/it] 22%|██▏       | 16/72 [04:52<17:01, 18.25s/it] 24%|██▎       | 17/72 [05:10<16:42, 18.23s/it] 25%|██▌       | 18/72 [05:28<16:24, 18.22s/it] 26%|██▋       | 19/72 [05:47<16:06, 18.23s/it] 28%|██▊       | 20/72 [06:05<15:47, 18.22s/it] 29%|██▉       | 21/72 [06:23<15:28, 18.21s/it] 31%|███       | 22/72 [06:41<15:09, 18.19s/it] 32%|███▏      | 23/72 [06:59<14:51, 18.19s/it] 33%|███▎      | 24/72 [07:18<14:32, 18.18s/it] 35%|███▍      | 25/72 [07:36<14:14, 18.19s/it] 36%|███▌      | 26/72 [07:54<13:56, 18.19s/it] 38%|███▊      | 27/72 [08:12<13:39, 18.21s/it] 39%|███▉      | 28/72 [08:31<13:21, 18.22s/it] 40%|████      | 29/72 [08:49<13:02, 18.20s/it] 42%|████▏     | 30/72 [09:07<12:44, 18.20s/it] 43%|████▎     | 31/72 [09:25<12:25, 18.19s/it] 44%|████▍     | 32/72 [09:43<12:06, 18.17s/it] 46%|████▌     | 33/72 [10:01<11:48, 18.17s/it] 47%|████▋     | 34/72 [10:20<11:30, 18.17s/it] 49%|████▊     | 35/72 [10:38<11:12, 18.18s/it] 50%|█████     | 36/72 [10:56<10:56, 18.24s/it] 51%|█████▏    | 37/72 [11:15<10:40, 18.30s/it] 53%|█████▎    | 38/72 [11:33<10:22, 18.29s/it] 54%|█████▍    | 39/72 [11:51<10:03, 18.29s/it] 56%|█████▌    | 40/72 [12:09<09:44, 18.28s/it] 57%|█████▋    | 41/72 [12:28<09:26, 18.28s/it] 58%|█████▊    | 42/72 [12:46<09:08, 18.29s/it] 60%|█████▉    | 43/72 [13:04<08:51, 18.34s/it] 61%|██████    | 44/72 [13:23<08:34, 18.38s/it] 62%|██████▎   | 45/72 [13:41<08:16, 18.37s/it] 64%|██████▍   | 46/72 [13:59<07:56, 18.34s/it] 65%|██████▌   | 47/72 [14:18<07:38, 18.34s/it] 67%|██████▋   | 48/72 [14:36<07:19, 18.33s/it] 68%|██████▊   | 49/72 [14:54<07:01, 18.34s/it] 69%|██████▉   | 50/72 [15:13<06:43, 18.35s/it] 71%|███████   | 51/72 [15:31<06:24, 18.32s/it] 72%|███████▏  | 52/72 [15:49<06:06, 18.30s/it] 74%|███████▎  | 53/72 [16:08<05:48, 18.35s/it] 75%|███████▌  | 54/72 [16:27<05:32, 18.46s/it] 76%|███████▋  | 55/72 [16:45<05:15, 18.55s/it] 78%|███████▊  | 56/72 [17:04<04:57, 18.57s/it] 79%|███████▉  | 57/72 [17:23<04:40, 18.67s/it] 81%|████████  | 58/72 [17:42<04:21, 18.71s/it] 82%|████████▏ | 59/72 [18:00<04:03, 18.71s/it] 83%|████████▎ | 60/72 [18:19<03:44, 18.71s/it] 85%|████████▍ | 61/72 [18:37<03:24, 18.60s/it] 86%|████████▌ | 62/72 [18:56<03:04, 18.48s/it] 88%|████████▊ | 63/72 [19:14<02:45, 18.44s/it] 89%|████████▉ | 64/72 [19:32<02:27, 18.39s/it] 90%|█████████ | 65/72 [19:51<02:08, 18.36s/it] 92%|█████████▏| 66/72 [20:09<01:49, 18.33s/it] 93%|█████████▎| 67/72 [20:27<01:31, 18.30s/it] 94%|█████████▍| 68/72 [20:45<01:13, 18.30s/it] 96%|█████████▌| 69/72 [21:04<00:54, 18.29s/it] 97%|█████████▋| 70/72 [21:22<00:36, 18.26s/it] 99%|█████████▊| 71/72 [21:40<00:18, 18.34s/it]100%|██████████| 72/72 [21:58<00:00, 18.03s/it]100%|██████████| 72/72 [21:58<00:00, 18.31s/it]
Experiment ended at 2023-10-15 12:18:48.672195. Total time taken 0:21:58.121258.
           metric   area      comp      suff
0        accuracy  0.050  0.966065  0.973878
1        accuracy  0.075  0.966065  0.973444
2        accuracy  0.100  0.964329  0.972930
3        accuracy  0.150  0.963895  0.968236
4             auc  0.050  0.689442  0.696245
5             auc  0.075  0.656561  0.706679
6             auc  0.100  0.614436  0.715621
7             auc  0.150  0.551595  0.725575
8   cross_entropy  0.050  0.103766  0.115665
9   cross_entropy  0.075  0.114826  0.117350
10  cross_entropy  0.100  0.126829  0.117357
11  cross_entropy  0.150  0.141850  0.120929
Running gradient_shap from 2023-10-15 12:18:48.709131
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:18<21:40, 18.32s/it]  3%|▎         | 2/72 [00:36<21:22, 18.32s/it]  4%|▍         | 3/72 [00:54<21:01, 18.28s/it]  6%|▌         | 4/72 [01:13<20:43, 18.29s/it]  7%|▋         | 5/72 [01:31<20:28, 18.34s/it]  8%|▊         | 6/72 [01:49<20:08, 18.31s/it] 10%|▉         | 7/72 [02:08<19:47, 18.27s/it] 11%|█         | 8/72 [02:26<19:28, 18.25s/it] 12%|█▎        | 9/72 [02:44<19:10, 18.27s/it] 14%|█▍        | 10/72 [03:02<18:52, 18.27s/it] 15%|█▌        | 11/72 [03:21<18:34, 18.27s/it] 17%|█▋        | 12/72 [03:39<18:16, 18.28s/it] 18%|█▊        | 13/72 [03:57<17:59, 18.30s/it] 19%|█▉        | 14/72 [04:16<17:45, 18.38s/it] 21%|██        | 15/72 [04:34<17:24, 18.32s/it] 22%|██▏       | 16/72 [04:52<17:06, 18.33s/it] 24%|██▎       | 17/72 [05:11<16:46, 18.31s/it] 25%|██▌       | 18/72 [05:29<16:29, 18.32s/it] 26%|██▋       | 19/72 [05:47<16:11, 18.33s/it] 28%|██▊       | 20/72 [06:06<15:51, 18.30s/it] 29%|██▉       | 21/72 [06:24<15:33, 18.31s/it] 31%|███       | 22/72 [06:42<15:13, 18.26s/it] 32%|███▏      | 23/72 [07:00<14:54, 18.26s/it] 33%|███▎      | 24/72 [07:18<14:35, 18.24s/it] 35%|███▍      | 25/72 [07:37<14:17, 18.24s/it] 36%|███▌      | 26/72 [07:55<13:59, 18.25s/it] 38%|███▊      | 27/72 [08:13<13:40, 18.23s/it] 39%|███▉      | 28/72 [08:31<13:21, 18.21s/it] 40%|████      | 29/72 [08:50<13:03, 18.22s/it] 42%|████▏     | 30/72 [09:08<12:45, 18.23s/it] 43%|████▎     | 31/72 [09:26<12:26, 18.21s/it] 44%|████▍     | 32/72 [09:44<12:08, 18.20s/it] 46%|████▌     | 33/72 [10:02<11:50, 18.22s/it] 47%|████▋     | 34/72 [10:21<11:31, 18.21s/it] 49%|████▊     | 35/72 [10:39<11:13, 18.20s/it] 50%|█████     | 36/72 [10:57<10:54, 18.19s/it] 51%|█████▏    | 37/72 [11:15<10:38, 18.24s/it] 53%|█████▎    | 38/72 [11:33<10:19, 18.21s/it] 54%|█████▍    | 39/72 [11:52<10:01, 18.21s/it] 56%|█████▌    | 40/72 [12:10<09:43, 18.23s/it] 57%|█████▋    | 41/72 [12:28<09:25, 18.23s/it] 58%|█████▊    | 42/72 [12:46<09:06, 18.23s/it] 60%|█████▉    | 43/72 [13:05<08:47, 18.21s/it] 61%|██████    | 44/72 [13:23<08:29, 18.19s/it] 62%|██████▎   | 45/72 [13:41<08:10, 18.17s/it] 64%|██████▍   | 46/72 [13:59<07:53, 18.21s/it] 65%|██████▌   | 47/72 [14:17<07:35, 18.22s/it] 67%|██████▋   | 48/72 [14:36<07:17, 18.23s/it] 68%|██████▊   | 49/72 [14:54<06:59, 18.23s/it] 69%|██████▉   | 50/72 [15:12<06:40, 18.22s/it] 71%|███████   | 51/72 [15:30<06:22, 18.20s/it] 72%|███████▏  | 52/72 [15:48<06:03, 18.17s/it] 74%|███████▎  | 53/72 [16:07<05:45, 18.18s/it] 75%|███████▌  | 54/72 [16:25<05:27, 18.21s/it] 76%|███████▋  | 55/72 [16:43<05:09, 18.21s/it] 78%|███████▊  | 56/72 [17:01<04:51, 18.24s/it] 79%|███████▉  | 57/72 [17:19<04:33, 18.22s/it] 81%|████████  | 58/72 [17:38<04:15, 18.23s/it] 82%|████████▏ | 59/72 [17:56<03:56, 18.20s/it] 83%|████████▎ | 60/72 [18:14<03:38, 18.20s/it] 85%|████████▍ | 61/72 [18:32<03:20, 18.26s/it] 86%|████████▌ | 62/72 [18:51<03:02, 18.24s/it] 88%|████████▊ | 63/72 [19:09<02:45, 18.34s/it] 89%|████████▉ | 64/72 [19:28<02:26, 18.33s/it] 90%|█████████ | 65/72 [19:46<02:08, 18.29s/it] 92%|█████████▏| 66/72 [20:04<01:49, 18.27s/it] 93%|█████████▎| 67/72 [20:22<01:31, 18.27s/it] 94%|█████████▍| 68/72 [20:40<01:13, 18.26s/it] 96%|█████████▌| 69/72 [20:59<00:54, 18.24s/it] 97%|█████████▋| 70/72 [21:17<00:36, 18.27s/it] 99%|█████████▊| 71/72 [21:35<00:18, 18.27s/it]100%|██████████| 72/72 [21:53<00:00, 17.96s/it]100%|██████████| 72/72 [21:53<00:00, 18.24s/it]
Experiment ended at 2023-10-15 12:40:41.728787. Total time taken 0:21:53.019656.
           metric   area      comp      suff
0        accuracy  0.050  0.965278  0.971354
1        accuracy  0.075  0.963542  0.969618
2        accuracy  0.100  0.963976  0.970052
3        accuracy  0.150  0.963542  0.970920
4             auc  0.050  0.645093  0.639433
5             auc  0.075  0.617785  0.654861
6             auc  0.100  0.580866  0.661209
7             auc  0.150  0.519186  0.670089
8   cross_entropy  0.050  0.100585  0.115619
9   cross_entropy  0.075  0.112170  0.116490
10  cross_entropy  0.100  0.122798  0.119300
11  cross_entropy  0.150  0.137510  0.122430
Running integrated_gradients from 2023-10-15 12:40:41.755553
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:18<21:27, 18.13s/it]  3%|▎         | 2/72 [00:36<21:10, 18.15s/it]  4%|▍         | 3/72 [00:54<20:52, 18.15s/it]  6%|▌         | 4/72 [01:13<20:46, 18.33s/it]  7%|▋         | 5/72 [01:31<20:41, 18.52s/it]  8%|▊         | 6/72 [01:50<20:27, 18.59s/it] 10%|▉         | 7/72 [02:09<20:09, 18.60s/it] 11%|█         | 8/72 [02:27<19:46, 18.54s/it] 12%|█▎        | 9/72 [02:45<19:20, 18.42s/it] 14%|█▍        | 10/72 [03:04<18:58, 18.36s/it] 15%|█▌        | 11/72 [03:22<18:36, 18.30s/it] 17%|█▋        | 12/72 [03:40<18:16, 18.28s/it] 18%|█▊        | 13/72 [03:58<17:57, 18.26s/it] 19%|█▉        | 14/72 [04:16<17:38, 18.25s/it] 21%|██        | 15/72 [04:35<17:21, 18.27s/it] 22%|██▏       | 16/72 [04:53<17:01, 18.24s/it] 24%|██▎       | 17/72 [05:11<16:42, 18.22s/it] 25%|██▌       | 18/72 [05:29<16:24, 18.23s/it] 26%|██▋       | 19/72 [05:48<16:05, 18.22s/it] 28%|██▊       | 20/72 [06:06<15:47, 18.22s/it] 29%|██▉       | 21/72 [06:24<15:29, 18.23s/it] 31%|███       | 22/72 [06:42<15:11, 18.23s/it] 32%|███▏      | 23/72 [07:00<14:52, 18.22s/it] 33%|███▎      | 24/72 [07:19<14:35, 18.23s/it] 35%|███▍      | 25/72 [07:37<14:16, 18.23s/it] 36%|███▌      | 26/72 [07:55<13:57, 18.21s/it] 38%|███▊      | 27/72 [08:13<13:38, 18.20s/it] 39%|███▉      | 28/72 [08:31<13:20, 18.20s/it] 40%|████      | 29/72 [08:50<13:02, 18.20s/it] 42%|████▏     | 30/72 [09:08<12:44, 18.19s/it] 43%|████▎     | 31/72 [09:26<12:26, 18.20s/it] 44%|████▍     | 32/72 [09:44<12:09, 18.23s/it] 46%|████▌     | 33/72 [10:02<11:50, 18.21s/it] 47%|████▋     | 34/72 [10:21<11:32, 18.23s/it] 49%|████▊     | 35/72 [10:39<11:14, 18.23s/it] 50%|█████     | 36/72 [10:57<10:56, 18.24s/it] 51%|█████▏    | 37/72 [11:15<10:38, 18.24s/it] 53%|█████▎    | 38/72 [11:34<10:19, 18.23s/it] 54%|█████▍    | 39/72 [11:52<10:01, 18.22s/it] 56%|█████▌    | 40/72 [12:10<09:43, 18.25s/it] 57%|█████▋    | 41/72 [12:29<09:27, 18.29s/it] 58%|█████▊    | 42/72 [12:47<09:07, 18.26s/it] 60%|█████▉    | 43/72 [13:05<08:48, 18.23s/it] 61%|██████    | 44/72 [13:23<08:30, 18.22s/it] 62%|██████▎   | 45/72 [13:41<08:11, 18.21s/it] 64%|██████▍   | 46/72 [14:00<07:53, 18.22s/it] 65%|██████▌   | 47/72 [14:18<07:35, 18.21s/it] 67%|██████▋   | 48/72 [14:36<07:17, 18.23s/it] 68%|██████▊   | 49/72 [14:54<06:58, 18.22s/it] 69%|██████▉   | 50/72 [15:12<06:40, 18.21s/it] 71%|███████   | 51/72 [15:31<06:22, 18.19s/it] 72%|███████▏  | 52/72 [15:49<06:06, 18.30s/it] 74%|███████▎  | 53/72 [16:08<05:49, 18.40s/it] 75%|███████▌  | 54/72 [16:26<05:32, 18.48s/it] 76%|███████▋  | 55/72 [16:45<05:15, 18.57s/it] 78%|███████▊  | 56/72 [17:04<04:57, 18.58s/it] 79%|███████▉  | 57/72 [17:22<04:38, 18.59s/it] 81%|████████  | 58/72 [17:41<04:19, 18.56s/it] 82%|████████▏ | 59/72 [17:59<04:00, 18.47s/it] 83%|████████▎ | 60/72 [18:17<03:40, 18.39s/it] 85%|████████▍ | 61/72 [18:36<03:21, 18.31s/it] 86%|████████▌ | 62/72 [18:54<03:02, 18.27s/it] 88%|████████▊ | 63/72 [19:12<02:44, 18.22s/it] 89%|████████▉ | 64/72 [19:30<02:25, 18.24s/it] 90%|█████████ | 65/72 [19:48<02:07, 18.22s/it] 92%|█████████▏| 66/72 [20:06<01:49, 18.22s/it] 93%|█████████▎| 67/72 [20:25<01:31, 18.22s/it] 94%|█████████▍| 68/72 [20:43<01:12, 18.19s/it] 96%|█████████▌| 69/72 [21:01<00:54, 18.22s/it] 97%|█████████▋| 70/72 [21:19<00:36, 18.23s/it] 99%|█████████▊| 71/72 [21:37<00:18, 18.21s/it]100%|██████████| 72/72 [21:55<00:00, 17.90s/it]100%|██████████| 72/72 [21:55<00:00, 18.27s/it]
Experiment ended at 2023-10-15 13:02:36.923616. Total time taken 0:21:55.168063.
           metric   area      comp      suff
0        accuracy  0.050  0.965985  0.968589
1        accuracy  0.075  0.964249  0.968155
2        accuracy  0.100  0.964683  0.973878
3        accuracy  0.150  0.963381  0.974392
4             auc  0.050  0.717198  0.720980
5             auc  0.075  0.682830  0.739677
6             auc  0.100  0.636029  0.743543
7             auc  0.150  0.560216  0.753315
8   cross_entropy  0.050  0.102270  0.117988
9   cross_entropy  0.075  0.113470  0.115487
10  cross_entropy  0.100  0.125136  0.115393
11  cross_entropy  0.150  0.140794  0.116399
