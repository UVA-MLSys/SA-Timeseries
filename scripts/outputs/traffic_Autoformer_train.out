Args in experiment:
Namespace(task_name='long_term_forecast', train=True, model='Autoformer', seed=2021, data='custom', result_path='./results', root_path='./dataset/traffic/', data_path='traffic.csv', flag='test', features='S', target='OT', freq='h', checkpoints='./checkpoints/', no_scale=False, group_id=None, seq_len=96, label_len=12, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=1, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=None, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des=None, loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, disable_progress=False, enc_in=1, dec_in=1, c_out=1)
Use GPU: cuda:0
Experiments will be saved in ./results/traffic_Autoformer
>>>>>>> training : >>>>>>>>>
train 13916
val 1732
Training started at 2023-10-12 20:29:11.737021.
	iters: 100, epoch: 1 | loss: 0.1615297
	speed: 0.0459s/iter; left time: 194.8592s
	iters: 200, epoch: 1 | loss: 0.2124493
	speed: 0.0319s/iter; left time: 132.0004s
	iters: 300, epoch: 1 | loss: 0.1648322
	speed: 0.0319s/iter; left time: 128.7307s
	iters: 400, epoch: 1 | loss: 0.1603103
	speed: 0.0318s/iter; left time: 125.1980s
Epoch: 1 cost time: 15.239872217178345
Epoch: 1, Steps: 434 | Train Loss: 0.17544 Vali Loss: 0.20641
Validation loss decreased (inf --> 0.206411).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0984960
	speed: 0.0500s/iter; left time: 190.4131s
	iters: 200, epoch: 2 | loss: 0.1389351
	speed: 0.0318s/iter; left time: 117.9825s
	iters: 300, epoch: 2 | loss: 0.0863951
	speed: 0.0315s/iter; left time: 113.4873s
	iters: 400, epoch: 2 | loss: 0.1088547
	speed: 0.0316s/iter; left time: 110.7748s
Epoch: 2 cost time: 13.741063833236694
Epoch: 2, Steps: 434 | Train Loss: 0.11231 Vali Loss: 0.18707
Validation loss decreased (0.206411 --> 0.187072).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0955881
	speed: 0.0481s/iter; left time: 162.3270s
	iters: 200, epoch: 3 | loss: 0.1209615
	speed: 0.0311s/iter; left time: 101.9355s
	iters: 300, epoch: 3 | loss: 0.1060155
	speed: 0.0314s/iter; left time: 99.5628s
	iters: 400, epoch: 3 | loss: 0.0821829
	speed: 0.0311s/iter; left time: 95.6684s
Epoch: 3 cost time: 13.55094861984253
Epoch: 3, Steps: 434 | Train Loss: 0.098169 Vali Loss: 0.15643
Validation loss decreased (0.187072 --> 0.156429).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0896359
	speed: 0.0484s/iter; left time: 142.2609s
	iters: 200, epoch: 4 | loss: 0.0979371
	speed: 0.0315s/iter; left time: 89.3313s
	iters: 300, epoch: 4 | loss: 0.0709135
	speed: 0.0318s/iter; left time: 87.0616s
	iters: 400, epoch: 4 | loss: 0.0787080
	speed: 0.0309s/iter; left time: 81.4210s
Epoch: 4 cost time: 13.60103440284729
Epoch: 4, Steps: 434 | Train Loss: 0.093399 Vali Loss: 0.15281
Validation loss decreased (0.156429 --> 0.152809).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0676201
	speed: 0.0483s/iter; left time: 120.8788s
	iters: 200, epoch: 5 | loss: 0.1211944
	speed: 0.0324s/iter; left time: 78.0121s
	iters: 300, epoch: 5 | loss: 0.0731312
	speed: 0.0322s/iter; left time: 74.2530s
	iters: 400, epoch: 5 | loss: 0.0872577
	speed: 0.0328s/iter; left time: 72.3412s
Epoch: 5 cost time: 14.018629789352417
Epoch: 5, Steps: 434 | Train Loss: 0.091708 Vali Loss: 0.15212
Validation loss decreased (0.152809 --> 0.152120).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0751346
	speed: 0.0506s/iter; left time: 104.7485s
	iters: 200, epoch: 6 | loss: 0.0578574
	speed: 0.0320s/iter; left time: 63.1327s
	iters: 300, epoch: 6 | loss: 0.0811563
	speed: 0.0319s/iter; left time: 59.6911s
	iters: 400, epoch: 6 | loss: 0.0922791
	speed: 0.0319s/iter; left time: 56.5404s
Epoch: 6 cost time: 13.96314024925232
Epoch: 6, Steps: 434 | Train Loss: 0.090788 Vali Loss: 0.14674
Validation loss decreased (0.152120 --> 0.146740).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0766230
	speed: 0.0492s/iter; left time: 80.5123s
	iters: 200, epoch: 7 | loss: 0.0589544
	speed: 0.0319s/iter; left time: 48.9585s
	iters: 300, epoch: 7 | loss: 0.0915307
	speed: 0.0319s/iter; left time: 45.8009s
	iters: 400, epoch: 7 | loss: 0.0680483
	speed: 0.0320s/iter; left time: 42.7261s
Epoch: 7 cost time: 13.85258436203003
Epoch: 7, Steps: 434 | Train Loss: 0.090404 Vali Loss: 0.14935
EarlyStopping counter: 1 out of 3
Loading model from ./results/traffic_Autoformer/checkpoint.pth
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1095034
	speed: 0.0495s/iter; left time: 59.5517s
	iters: 200, epoch: 8 | loss: 0.1435339
	speed: 0.0311s/iter; left time: 34.2958s
	iters: 300, epoch: 8 | loss: 0.1766683
	speed: 0.0309s/iter; left time: 30.9717s
	iters: 400, epoch: 8 | loss: 0.0782859
	speed: 0.0308s/iter; left time: 27.8235s
Epoch: 8 cost time: 13.589480638504028
Epoch: 8, Steps: 434 | Train Loss: 0.090375 Vali Loss: 0.15056
EarlyStopping counter: 2 out of 3
Loading model from ./results/traffic_Autoformer/checkpoint.pth
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1108894
	speed: 0.0472s/iter; left time: 36.2911s
	iters: 200, epoch: 9 | loss: 0.0930674
	speed: 0.0310s/iter; left time: 20.7216s
	iters: 300, epoch: 9 | loss: 0.0698675
	speed: 0.0310s/iter; left time: 17.6516s
	iters: 400, epoch: 9 | loss: 0.1154804
	speed: 0.0308s/iter; left time: 14.4613s
Epoch: 9 cost time: 13.419250965118408
Epoch: 9, Steps: 434 | Train Loss: 0.090197 Vali Loss: 0.14912
EarlyStopping counter: 3 out of 3
Early stopping
Training ended at 2023-10-12 20:31:22.363195, time taken 0:02:10.626174, per epoch 0:00:14.514019
Loading model from ./results/traffic_Autoformer/checkpoint.pth
val 1732
Preds and Trues shape: (1732, 24, 1) (1732, 24, 1)
flag:val, mse:0.14775, mae:0.29506, rmse: 0.38438.
>>>>>>> testing : <<<<<<<<<<<
test 1731
Preds and Trues shape: (1731, 24, 1) (1731, 24, 1)
flag:test, mse:0.31519, mae:0.39561, rmse: 0.56142.
