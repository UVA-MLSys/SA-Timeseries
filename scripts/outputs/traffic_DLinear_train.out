Args in experiment:
Namespace(task_name='long_term_forecast', train=True, model='DLinear', seed=2021, data='custom', result_path='./results', root_path='./dataset/traffic/', data_path='traffic.csv', flag='test', features='S', target='OT', freq='h', checkpoints='./checkpoints/', no_scale=False, group_id=None, seq_len=96, label_len=12, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=1, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=None, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des=None, loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, disable_progress=False, enc_in=1, dec_in=1, c_out=1)
Use GPU: cuda:0
Experiments will be saved in ./results/traffic_DLinear
>>>>>>> training : >>>>>>>>>
train 13916
val 1732
Training started at 2023-10-12 20:21:44.312596.
	iters: 100, epoch: 1 | loss: 0.3278082
	speed: 0.0113s/iter; left time: 47.7573s
	iters: 200, epoch: 1 | loss: 0.1625528
	speed: 0.0017s/iter; left time: 7.2375s
	iters: 300, epoch: 1 | loss: 0.1577797
	speed: 0.0018s/iter; left time: 7.0783s
	iters: 400, epoch: 1 | loss: 0.1232649
	speed: 0.0017s/iter; left time: 6.8733s
Epoch: 1 cost time: 1.7103862762451172
Epoch: 1, Steps: 434 | Train Loss: 0.28116 Vali Loss: 0.26225
Validation loss decreased (inf --> 0.262245).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1325228
	speed: 0.0041s/iter; left time: 15.7320s
	iters: 200, epoch: 2 | loss: 0.1388913
	speed: 0.0017s/iter; left time: 6.4783s
	iters: 300, epoch: 2 | loss: 0.1158802
	speed: 0.0018s/iter; left time: 6.3293s
	iters: 400, epoch: 2 | loss: 0.1122405
	speed: 0.0017s/iter; left time: 6.1325s
Epoch: 2 cost time: 0.7591984272003174
Epoch: 2, Steps: 434 | Train Loss: 0.1375 Vali Loss: 0.23518
Validation loss decreased (0.262245 --> 0.235185).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1253609
	speed: 0.0029s/iter; left time: 9.8876s
	iters: 200, epoch: 3 | loss: 0.2063461
	speed: 0.0017s/iter; left time: 5.7015s
	iters: 300, epoch: 3 | loss: 0.1019240
	speed: 0.0017s/iter; left time: 5.5237s
	iters: 400, epoch: 3 | loss: 0.1634846
	speed: 0.0017s/iter; left time: 5.3565s
Epoch: 3 cost time: 0.7581295967102051
Epoch: 3, Steps: 434 | Train Loss: 0.12912 Vali Loss: 0.22312
Validation loss decreased (0.235185 --> 0.223117).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1276524
	speed: 0.0029s/iter; left time: 8.6031s
	iters: 200, epoch: 4 | loss: 0.1425183
	speed: 0.0017s/iter; left time: 4.9269s
	iters: 300, epoch: 4 | loss: 0.1159878
	speed: 0.0017s/iter; left time: 4.7630s
	iters: 400, epoch: 4 | loss: 0.1065058
	speed: 0.0017s/iter; left time: 4.6065s
Epoch: 4 cost time: 0.7565567493438721
Epoch: 4, Steps: 434 | Train Loss: 0.12592 Vali Loss: 0.21967
Validation loss decreased (0.223117 --> 0.219669).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1238204
	speed: 0.0029s/iter; left time: 7.3324s
	iters: 200, epoch: 5 | loss: 0.1138076
	speed: 0.0017s/iter; left time: 4.1916s
	iters: 300, epoch: 5 | loss: 0.1148718
	speed: 0.0018s/iter; left time: 4.0746s
	iters: 400, epoch: 5 | loss: 0.1296023
	speed: 0.0017s/iter; left time: 3.8526s
Epoch: 5 cost time: 0.7608547210693359
Epoch: 5, Steps: 434 | Train Loss: 0.1245 Vali Loss: 0.21768
Validation loss decreased (0.219669 --> 0.217682).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1589271
	speed: 0.0029s/iter; left time: 6.0966s
	iters: 200, epoch: 6 | loss: 0.1138071
	speed: 0.0018s/iter; left time: 3.4592s
	iters: 300, epoch: 6 | loss: 0.1130718
	speed: 0.0018s/iter; left time: 3.2831s
	iters: 400, epoch: 6 | loss: 0.1046437
	speed: 0.0018s/iter; left time: 3.1084s
Epoch: 6 cost time: 0.7627012729644775
Epoch: 6, Steps: 434 | Train Loss: 0.12372 Vali Loss: 0.21661
Validation loss decreased (0.217682 --> 0.216606).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1741672
	speed: 0.0029s/iter; left time: 4.8026s
	iters: 200, epoch: 7 | loss: 0.1439554
	speed: 0.0017s/iter; left time: 2.6722s
	iters: 300, epoch: 7 | loss: 0.1077861
	speed: 0.0017s/iter; left time: 2.5110s
	iters: 400, epoch: 7 | loss: 0.1016665
	speed: 0.0018s/iter; left time: 2.3570s
Epoch: 7 cost time: 0.7593052387237549
Epoch: 7, Steps: 434 | Train Loss: 0.12334 Vali Loss: 0.21607
Validation loss decreased (0.216606 --> 0.216070).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1100419
	speed: 0.0029s/iter; left time: 3.5337s
	iters: 200, epoch: 8 | loss: 0.1016128
	speed: 0.0017s/iter; left time: 1.9224s
	iters: 300, epoch: 8 | loss: 0.1294947
	speed: 0.0017s/iter; left time: 1.7426s
	iters: 400, epoch: 8 | loss: 0.1895673
	speed: 0.0017s/iter; left time: 1.5754s
Epoch: 8 cost time: 0.7571284770965576
Epoch: 8, Steps: 434 | Train Loss: 0.12312 Vali Loss: 0.21578
Validation loss decreased (0.216070 --> 0.215783).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0925032
	speed: 0.0029s/iter; left time: 2.2525s
	iters: 200, epoch: 9 | loss: 0.1220452
	speed: 0.0017s/iter; left time: 1.1639s
	iters: 300, epoch: 9 | loss: 0.1368074
	speed: 0.0017s/iter; left time: 0.9924s
	iters: 400, epoch: 9 | loss: 0.1436238
	speed: 0.0018s/iter; left time: 0.8213s
Epoch: 9 cost time: 0.7581028938293457
Epoch: 9, Steps: 434 | Train Loss: 0.12304 Vali Loss: 0.21563
Validation loss decreased (0.215783 --> 0.215628).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1130501
	speed: 0.0029s/iter; left time: 0.9821s
	iters: 200, epoch: 10 | loss: 0.0963482
	speed: 0.0018s/iter; left time: 0.4146s
	iters: 300, epoch: 10 | loss: 0.1359029
	speed: 0.0017s/iter; left time: 0.2351s
	iters: 400, epoch: 10 | loss: 0.0886320
	speed: 0.0017s/iter; left time: 0.0610s
Epoch: 10 cost time: 0.7599091529846191
Epoch: 10, Steps: 434 | Train Loss: 0.12294 Vali Loss: 0.21555
Validation loss decreased (0.215628 --> 0.215547).  Saving model ...
Updating learning rate to 1.953125e-07
Training ended at 2023-10-12 20:21:53.558417, time taken 0:00:09.245821, per epoch 0:00:01.027313
Loading model from ./results/traffic_DLinear/checkpoint.pth
val 1732
Preds and Trues shape: (1732, 24, 1) (1732, 24, 1)
flag:val, mse:0.21484, mae:0.34768, rmse: 0.4635.
>>>>>>> testing : <<<<<<<<<<<
test 1731
Preds and Trues shape: (1731, 24, 1) (1731, 24, 1)
flag:test, mse:0.32674, mae:0.39523, rmse: 0.57161.
