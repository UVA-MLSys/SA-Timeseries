Namespace(task_name='long_term_forecast', train=False, model='MICN', seed=2024, itrs=3, itr_no=None, data='custom', result_path='./results', root_path='./dataset/traffic/', data_path='traffic.csv', flag='test', features='S', target='OT', freq='h', seq_len=96, label_len=12, pred_len=24, seasonal_patterns='Monthly', top_k=5, num_kernels=6, n_features=1, d_model=128, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, conv_kernel=[18, 12], seg_len=24, num_workers=0, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, lradj='type1', use_amp=False, use_cpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, explainers=['feature_ablation', 'occlusion', 'augmented_occlusion', 'winIT', 'tsr'], areas=[0.05, 0.075, 0.1, 0.15], baseline_mode='random', metrics=['mae', 'mse'], overwrite=True, dump_attrs=False, disable_progress=True, use_gpu=True, enc_in=1, dec_in=1, c_out=1)

>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
Experiments will be saved in ./results/traffic_MICN/1
test 1731
Loading model from ./results/traffic_MICN/1/checkpoint.pth
Running feature_ablation from 2024-07-08 00:25:08.948240
Experiment ended at 2024-07-08 00:56:20.441999. Total time taken 0:31:11.493759.
  metric   area       comp       suff
0    mae  0.050   8.380700  17.978208
1    mae  0.075  10.165179  15.857968
2    mae  0.100  11.099283  14.739280
3    mae  0.150  12.980936  12.548561
4    mse  0.050   5.766393  18.648387
5    mse  0.075   7.817547  14.566744
6    mse  0.100   8.984877  12.634782
7    mse  0.150  11.542649   9.278852

Running occlusion from 2024-07-08 00:56:20.660923
Experiment ended at 2024-07-08 00:59:44.335638. Total time taken 0:03:23.674715.
  metric   area       comp       suff
0    mae  0.050   8.381658  18.088858
1    mae  0.075  10.187778  15.955730
2    mae  0.100  11.124847  14.825559
3    mae  0.150  13.027996  12.605893
4    mse  0.050   5.792357  18.848729
5    mse  0.075   7.863328  14.737656
6    mse  0.100   9.047897  12.774226
7    mse  0.150  11.653265   9.359728

Running augmented_occlusion from 2024-07-08 00:59:44.522175
Experiment ended at 2024-07-08 01:03:07.767837. Total time taken 0:03:23.245662.
  metric   area       comp       suff
0    mae  0.050   6.477298  20.152997
1    mae  0.075   8.087959  18.502219
2    mae  0.100   8.821477  17.644018
3    mae  0.150  10.202337  15.973060
4    mse  0.050   3.878243  23.442815
5    mse  0.075   5.452440  19.887815
6    mse  0.100   6.243605  18.166918
7    mse  0.150   7.846399  15.043772

Running winIT from 2024-07-08 01:03:07.954404
Traceback (most recent call last):
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 73, in <module>
    main(args)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/interpret.py", line 42, in main
    interpreter.interpret(dataloader)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 185, in interpret
    results, attrs = self.run_regressor(dataloader, name)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 159, in run_regressor
    batch_results, batch_attr = self.evaluate(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/exp/exp_interpret.py", line 210, in evaluate
    attr = compute_attr(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/explainer.py", line 103, in compute_attr
    attr = explainer.attribute(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 140, in attribute
    return self._attribute_tuple(
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/utils/winIT.py", line 188, in _attribute_tuple
    model(*tuple(inputs_hat), *additional_forward_args)
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/models/MICN.py", line 220, in forward
    dec_out = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/models/MICN.py", line 178, in forecast
    dec_out = self.conv_trans(dec_out)
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/models/MICN.py", line 103, in forward
    dec = mic_layer(dec)
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/models/MICN.py", line 73, in forward
    src_out, trend1 = self.decomp[i](src)
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/layers/Autoformer_EncDec.py", line 51, in forward
    moving_mean = self.moving_avg(x)
  File "/home/mi3se/.conda/envs/ml/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/sfs/gpfs/tardis/project/bii_dsc_community/khairul/SA-Timeseries/layers/Autoformer_EncDec.py", line 35, in forward
    x = torch.cat([front, x, end], dim=1)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 31.73 GiB total capacity; 30.74 GiB already allocated; 1.81 MiB free; 31.19 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
